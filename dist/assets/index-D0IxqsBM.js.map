{"version":3,"file":"index-D0IxqsBM.js","sources":["../../src/composables/useState.js","../../src/composables/useCanvas.js","../../src/composables/useNodes.js","../../src/App.vue","../../src/main.js"],"sourcesContent":["\nimport { reactive, ref } from 'vue';\nimport placeNodes from '../services/nodePositioning.js';\n\n/**\n * @typedef {Object} Territory\n * @property {string} id - Unique identifier\n * @property {string} label - Display name\n * @property {number} x - X coordinate\n * @property {number} y - Y coordinate\n * @property {number} w - Width\n * @property {number} h - Height\n */\n\n/**\n * @typedef {Object} Node\n * @property {string} id - Unique identifier\n * @property {string} label - Display name\n * @property {number} x - X coordinate\n * @property {number} y - Y coordinate\n * @property {string|null} territoryId - Parent territory ID\n * @property {string} note - User notes\n * @property {'todo'|'in-progress'|'done'} status - Task status\n * @property {number} timestamp - Creation time\n */\n\n/**\n * @typedef {Object} Edge\n * @property {string} id - Unique identifier\n * @property {string} source - Source node ID\n * @property {string} target - Target node ID\n */\n\n/**\n * @typedef {Object} SWOT\n * @property {string} strengths\n * @property {string} weaknesses\n * @property {string} opportunities\n * @property {string} threats\n */\n\n// --- CORE DATA STATE (EXPORTED FOR GLOBAL ACCESS) ---\n/** @type {import('vue').UnwrapRef<Territory[]>} */\nexport const territories = reactive([]);\n\n/** @type {import('vue').UnwrapRef<Node[]>} */\nexport const nodes = reactive([]);\n\n/** @type {import('vue').UnwrapRef<Edge[]>} */\nexport const edges = reactive([]);\n\n// --- FEATURE/UI STATE ---\nexport const chatInput = ref('');\nexport const isGenerating = ref(false); // Loading state for LLM calls\n\n/** @type {import('vue').UnwrapRef<SWOT>} */\nexport const swot = reactive({ strengths:'', weaknesses:'', opportunities:'', threats:'' });\n\n// ---------- AUTO-SAVE / AUTO-LOAD (Basic Persistence) ----------\nconst AUTO_SAVE_KEY = 'hikki-canvas-state';\n\n/**\n * Auto-save current canvas state to localStorage\n * Called automatically after map generation and on changes\n */\nexport function autoSave() {\n    try {\n        const state = {\n            territories: JSON.parse(JSON.stringify(territories)),\n            nodes: JSON.parse(JSON.stringify(nodes)),\n            edges: JSON.parse(JSON.stringify(edges)),\n            timestamp: Date.now()\n        };\n        localStorage.setItem(AUTO_SAVE_KEY, JSON.stringify(state));\n        console.log('💾 Auto-saved canvas state');\n    } catch (error) {\n        console.error('Auto-save failed:', error);\n    }\n}\n\n/**\n * Auto-load canvas state from localStorage\n * Called on page load\n * @returns {boolean} True if state was loaded successfully\n */\nexport function autoLoad() {\n    try {\n        const saved = localStorage.getItem(AUTO_SAVE_KEY);\n        if (!saved) {\n            console.log('No saved state found');\n            return false;\n        }\n\n        const state = JSON.parse(saved);\n\n        // Clear current state\n        territories.splice(0);\n        nodes.splice(0);\n        edges.splice(0);\n\n        // Load saved data\n        (state.territories || []).forEach(t => territories.push(t));\n        (state.nodes || []).forEach(n => nodes.push(n));\n        (state.edges || []).forEach(e => edges.push(e));\n\n        console.log('✅ Auto-loaded canvas state from', new Date(state.timestamp).toLocaleString());\n        return true;\n    } catch (error) {\n        console.error('Auto-load failed:', error);\n        return false;\n    }\n}\n\n// ---------- SNAPSHOT (localStorage simple) ----------\n/**\n * Save current state to localStorage history\n * @param {string} [name] - Optional snapshot name\n * @throws {Error} If localStorage is unavailable\n */\nexport function saveSnapshot(name) {\n    try {\n        const raw = localStorage.getItem('mvp-history');\n        const history = raw ? JSON.parse(raw) : [];\n\n        // Ensure deep copy for saving the current state\n        const data = {\n            territories: JSON.parse(JSON.stringify(territories)),\n            nodes: JSON.parse(JSON.stringify(nodes)),\n            edges: JSON.parse(JSON.stringify(edges)),\n            swot: {...swot},\n            ts: Date.now(),\n            name\n        };\n\n        history.push({\n            id: crypto.randomUUID(),\n            ts: Date.now(),\n            name: name || `snap-${history.length+1}`,\n            data\n        });\n\n        localStorage.setItem('mvp-history', JSON.stringify(history));\n    } catch (error) {\n        console.error('Failed to save snapshot:', error);\n        throw new Error(`Snapshot save failed: ${error.message}`);\n    }\n}\n\n/**\n * Load snapshot from history by index\n * @param {number} index - Snapshot index in history array\n * @throws {Error} If snapshot not found or invalid\n */\nexport function loadSnapshot(index) {\n    try {\n        const raw = localStorage.getItem('mvp-history');\n        if (!raw) {\n            throw new Error('No saved history found');\n        }\n\n        const history = JSON.parse(raw);\n        const snap = history[index];\n\n        if (!snap || !snap.data) {\n            throw new Error(`Invalid snapshot at index ${index}`);\n        }\n\n        // Clear current state and push new data (maintaining reactivity)\n        territories.splice(0);\n        nodes.splice(0);\n        edges.splice(0);\n\n        (snap.data.territories || []).forEach(t => territories.push(t));\n        (snap.data.nodes || []).forEach(n => nodes.push(n));\n        (snap.data.edges || []).forEach(e => edges.push(e));\n\n        // Restore SWOT if available\n        if (snap.data.swot) {\n            Object.assign(swot, snap.data.swot);\n        }\n    } catch (error) {\n        console.error('Failed to load snapshot:', error);\n        throw new Error(`Snapshot load failed: ${error.message}`);\n    }\n}\n\n// ---------- TERRITORY POSITIONING CONSTANTS ----------\nconst TERRITORY_PADDING = 20;      // px from edges\nconst TERRITORY_HEADER = 60;       // Space for territory title\nconst NODE_WIDTH = 180;\nconst NODE_HEIGHT = 80;\nconst NODE_SPACING_X = 20;         // Horizontal spacing between nodes\nconst NODE_SPACING_Y = 20;         // Vertical spacing between nodes\nconst COLS_PER_TERRITORY = 2;      // Number of columns in territory grid\nconst TERRITORY_SPACING = 50;      // Space between territories\nconst TERRITORY_COLS = 3;          // Number of territory columns in layout\n\n/**\n * Calculate optimal territory dimensions based on number of nodes\n * @param {number} nodeCount - Number of nodes in territory\n * @returns {{ width: number, height: number }}\n */\nfunction calculateTerritoryDimensions(nodeCount) {\n    const rows = Math.ceil(nodeCount / COLS_PER_TERRITORY);\n\n    const width =\n        TERRITORY_PADDING * 2 +\n        (COLS_PER_TERRITORY * NODE_WIDTH) +\n        ((COLS_PER_TERRITORY - 1) * NODE_SPACING_X);\n\n    const height =\n        TERRITORY_HEADER +\n        TERRITORY_PADDING * 2 +\n        (rows * NODE_HEIGHT) +\n        ((rows - 1) * NODE_SPACING_Y);\n\n    // Minimum dimensions\n    return {\n        width: Math.max(width, 400),\n        height: Math.max(height, 350)\n    };\n}\n\n/**\n * Position a node inside its territory with bounds checking\n * @param {Node} node - Node to position\n * @param {Territory} territory - Parent territory\n * @param {number} indexInTerritory - Index of node within territory\n * @returns {{ x: number, y: number }}\n */\nfunction positionNodeInTerritory(node, territory, indexInTerritory) {\n    const col = indexInTerritory % COLS_PER_TERRITORY;\n    const row = Math.floor(indexInTerritory / COLS_PER_TERRITORY);\n\n    // Calculate initial position\n    const x = territory.x + TERRITORY_PADDING + (col * (NODE_WIDTH + NODE_SPACING_X));\n    const y = territory.y + TERRITORY_HEADER + TERRITORY_PADDING + (row * (NODE_HEIGHT + NODE_SPACING_Y));\n\n    // CRITICAL: Ensure node doesn't exceed territory bounds\n    const maxX = territory.x + territory.w - NODE_WIDTH - TERRITORY_PADDING;\n    const maxY = territory.y + territory.h - NODE_HEIGHT - TERRITORY_PADDING;\n\n    const finalX = Math.min(x, maxX);\n    const finalY = Math.min(y, maxY);\n\n    // Visual debugging - check if clamping occurred\n    if (x !== finalX || y !== finalY) {\n        console.warn(`⚠️ Node \"${node.label}\" clamped in territory \"${territory.label}\":`, {\n            original: { x, y },\n            clamped: { x: finalX, y: finalY },\n            territory: {\n                bounds: {\n                    x: territory.x,\n                    y: territory.y,\n                    w: territory.w,\n                    h: territory.h\n                },\n                maxAllowed: { x: maxX, y: maxY }\n            }\n        });\n    }\n\n    return { x: finalX, y: finalY };\n}\n\n// ---------- NODE MANAGEMENT ----------\n/**\n * Delete a node and all its connected edges\n * @param {string} nodeId - ID of the node to delete\n * @returns {boolean} True if node was deleted successfully\n */\nexport function deleteNode(nodeId) {\n    try {\n        // Find the node\n        const nodeIndex = nodes.findIndex(n => n.id === nodeId);\n        if (nodeIndex === -1) {\n            console.warn(`Node ${nodeId} not found`);\n            return false;\n        }\n\n        const node = nodes[nodeIndex];\n        console.log(`🗑️ Deleting node \"${node.label}\" (${nodeId})`);\n\n        // Remove the node from the array\n        nodes.splice(nodeIndex, 1);\n\n        // Remove all edges connected to this node\n        const edgesToRemove = edges.filter(e => e.source === nodeId || e.target === nodeId);\n        edgesToRemove.forEach(edge => {\n            const edgeIndex = edges.findIndex(e => e.id === edge.id);\n            if (edgeIndex !== -1) {\n                edges.splice(edgeIndex, 1);\n                console.log(`  → Removed edge ${edge.id}`);\n            }\n        });\n\n        // Remove node from its parent territory's nodeIds\n        territories.forEach(territory => {\n            if (territory.nodeIds && territory.nodeIds.includes(nodeId)) {\n                const idIndex = territory.nodeIds.indexOf(nodeId);\n                territory.nodeIds.splice(idIndex, 1);\n                console.log(`  → Removed from territory \"${territory.label}\"`);\n            }\n        });\n\n        // Auto-save after deletion\n        autoSave();\n\n        console.log(`✅ Node deleted successfully (${edgesToRemove.length} edges removed)`);\n        return true;\n    } catch (error) {\n        console.error('Failed to delete node:', error);\n        return false;\n    }\n}\n\n// ---------- STUBS for analysis & map generation ----------\nexport function runAnalysis() {\n    // rule-based stub: fill swot from chatInput for demo\n    if (chatInput.value.toLowerCase().includes('ielts')) {\n      swot.strengths = 'Good listening';\n      swot.weaknesses = 'Timing in writing';\n    } else {\n      swot.strengths = 'Creative';\n    }\n    alert('SWOT drafted (stub).');\n}\n\nexport async function generateMap() {\n    if (isGenerating.value) {\n        console.warn('Map generation already in progress');\n        return;\n    }\n\n    try {\n        isGenerating.value = true;\n        console.log('🚀 Starting map generation...');\n\n        // Clear existing data\n        territories.splice(0); nodes.splice(0); edges.splice(0);\n\n        // Call backend API to generate map using LLM (same server, relative path)\n        const response = await fetch('/api/generate', {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({\n                prompt: chatInput.value || 'Create a learning plan for IELTS preparation with listening, reading, writing, and speaking skills'\n            })\n        });\n\n        if (!response.ok) {\n            const errorData = await response.json().catch(() => null);\n            const errorMessage = errorData?.error || `Server error: ${response.status}`;\n            throw new Error(errorMessage);\n        }\n\n        const data = await response.json();\n\n        // Check if LLM succeeded\n        if (!data.success) {\n            throw new Error(data.error || 'Map generation failed');\n        }\n\n        // Warn if fallback was used\n        if (data.metadata?.fallback) {\n            console.warn('⚠️ Using fallback map - LLM response was invalid');\n            alert('Warning: Map generation used fallback mode. Results may be limited.');\n        }\n\n        const mapData = data.data; // Backend returns { success: true, data: mapJson }\n\n        // LLM returns nodes WITH x,y coordinates - override them with our positioning algorithm\n        const llmNodes = mapData.nodes.map(n => ({\n            id: n.id || crypto.randomUUID(),\n            label: n.label,\n            type: n.type || 'concept',\n            note: '',\n            status: 'todo',\n            timestamp: Date.now()\n        }));\n\n        const llmEdges = mapData.edges.map(e => ({\n            id: e.id || crypto.randomUUID(),\n            source: e.source,\n            target: e.target,\n            type: e.type || 'relationship'\n        }));\n\n        // Add to state\n        llmNodes.forEach(n => nodes.push(n));\n        llmEdges.forEach(e => edges.push(e));\n\n        // Handle territories from LLM FIRST (before positioning nodes)\n        if (mapData.territories && mapData.territories.length > 0) {\n            console.log('🗺️ Creating territories with dynamic sizing...');\n\n            mapData.territories.forEach((t, index) => {\n                const nodeCount = (t.nodeIds || []).length;\n\n                // Calculate dimensions based on node count\n                const dimensions = calculateTerritoryDimensions(nodeCount);\n\n                // Position territories in a grid layout\n                const col = index % TERRITORY_COLS;\n                const row = Math.floor(index / TERRITORY_COLS);\n\n                const territory = {\n                    id: t.id || crypto.randomUUID(),\n                    label: t.name,\n                    x: 100 + col * (dimensions.width + TERRITORY_SPACING),\n                    y: 100 + row * (dimensions.height + TERRITORY_SPACING),\n                    w: dimensions.width,\n                    h: dimensions.height,\n                    nodeIds: t.nodeIds || []\n                };\n\n                territories.push(territory);\n\n                // Debug log\n                console.log(`  📦 Territory \"${territory.label}\":`, {\n                    nodes: nodeCount,\n                    dimensions: { w: dimensions.width, h: dimensions.height },\n                    position: { x: territory.x, y: territory.y }\n                });\n            });\n        }\n\n        // Position nodes INSIDE their territories\n        console.log('\\n📍 Positioning nodes within territories...');\n        let nodesPositioned = 0;\n        let nodesOutside = 0;\n\n        nodes.forEach(node => {\n            // Find which territory this node belongs to\n            const territory = territories.find(t =>\n                t.nodeIds && t.nodeIds.includes(node.id)\n            );\n\n            if (territory) {\n                // Find index within territory\n                const indexInTerritory = territory.nodeIds.indexOf(node.id);\n\n                // Use helper function with bounds checking\n                const position = positionNodeInTerritory(node, territory, indexInTerritory);\n                node.x = position.x;\n                node.y = position.y;\n\n                nodesPositioned++;\n\n                // Debug: verify node is within bounds\n                const isWithinBounds =\n                    node.x >= territory.x &&\n                    node.x + NODE_WIDTH <= territory.x + territory.w &&\n                    node.y >= territory.y &&\n                    node.y + NODE_HEIGHT <= territory.y + territory.h;\n\n                if (!isWithinBounds) {\n                    console.error(`❌ Node \"${node.label}\" STILL outside territory \"${territory.label}\"!`, {\n                        node: { x: node.x, y: node.y },\n                        territory: { x: territory.x, y: territory.y, w: territory.w, h: territory.h }\n                    });\n                }\n            } else {\n                // Fallback: random position if no territory\n                node.x = Math.random() * 800 + 100;\n                node.y = Math.random() * 600 + 100;\n                nodesOutside++;\n                console.warn(`⚠️ Node \"${node.label}\" has no territory assignment`);\n            }\n        });\n\n        console.log(`✓ Positioned ${nodesPositioned} nodes, ${nodesOutside} outside territories`);\n\n        saveSnapshot('auto-generate');\n        autoSave(); // Auto-save after successful generation\n        console.log('✅ Map generation complete!');\n        console.log(`   → ${territories.length} territories`);\n        console.log(`   → ${nodes.length} nodes`);\n        console.log(`   → ${edges.length} edges`);\n    } catch (error) {\n        console.error('❌ Map generation failed:', error);\n\n        // Show user-friendly error message\n        let userMessage = 'Failed to generate map. ';\n\n        if (error.message.includes('Rate limit') || error.message.includes('busy')) {\n            userMessage += 'The AI service is currently busy. Please wait a moment and try again.';\n        } else if (error.message.includes('API key') || error.message.includes('not configured')) {\n            userMessage += 'API configuration error. Please check your API keys.';\n        } else if (error.message.includes('Invalid map structure')) {\n            userMessage += 'The AI returned an invalid response. Please try a different prompt.';\n        } else {\n            userMessage += error.message;\n        }\n\n        alert(userMessage);\n\n        // Re-throw to prevent partial state\n        throw error;\n    } finally {\n        isGenerating.value = false;\n    }\n}\n\nexport function useState() {\n    return {\n        // Data arrays\n        territories, nodes, edges,\n        // Feature state\n        chatInput, swot, isGenerating,\n        // Functions\n        saveSnapshot, loadSnapshot, runAnalysis, generateMap,\n        autoSave, autoLoad, deleteNode\n    }\n}","// src/composables/useCanvas.js\nimport { reactive, ref, onMounted, onUnmounted } from 'vue';\n\n/**\n * @typedef {Object} ViewBox\n * @property {number} x - X offset\n * @property {number} y - Y offset\n * @property {number} w - Width\n * @property {number} h - Height\n */\n\n/**\n * @typedef {Object} Point\n * @property {number} x - X coordinate\n * @property {number} y - Y coordinate\n */\n\nconst initView = reactive({ x: 0, y: 0, w: 1600, h: 900 });\n\n/** @type {import('vue').UnwrapRef<ViewBox>} */\nexport const viewBox = reactive({ x: initView.x, y: initView.y, w: initView.w, h: initView.h });\n\nconst isPanning = ref(false);\nconst lastPan = reactive({ x: 0, y: 0 });\n\n// ---------- UTIL: coord conversion (EXPORTED) ----------\n/**\n * Convert screen mouse event to world coordinates\n * @param {MouseEvent} e - Mouse event\n * @returns {Point} World coordinates\n */\nexport function svgToWorld(e) {\n  const svg = document.querySelector('svg');\n  if (!svg) {\n    console.warn('SVG element not found');\n    return { x: 0, y: 0 };\n  }\n\n  const r = svg.getBoundingClientRect();\n  const px = (e.clientX - r.left) / r.width;\n  const py = (e.clientY - r.top) / r.height;\n\n  return {\n    x: viewBox.x + px * viewBox.w,\n    y: viewBox.y + py * viewBox.h\n  };\n}\n\n/**\n * Convert world node coordinates to screen position\n * @param {Object} node - Node with x, y properties\n * @param {number} node.x - World X coordinate\n * @param {number} node.y - World Y coordinate\n * @returns {Point & {rect: DOMRect}} Screen coordinates with SVG rect\n */\nexport function worldToScreen(node) {\n  const svg = document.querySelector('svg');\n  if (!svg) {\n    console.warn('SVG element not found');\n    return { x: 0, y: 0, rect: null };\n  }\n\n  const r = svg.getBoundingClientRect();\n  const sx = ((node.x - viewBox.x) / viewBox.w) * r.width + r.left;\n  const sy = ((node.y - viewBox.y) / viewBox.h) * r.height + r.top;\n\n  return { x: sx, y: sy, rect: r };\n}\n\n// ---------- PAN (canvas dragging) ----------\nexport function onPanStart(e) {\n  isPanning.value = true;\n  lastPan.x = e.clientX;\n  lastPan.y = e.clientY;\n}\nexport function onPanMove(e) {\n  if (!isPanning.value) return;\n  const svg = e.currentTarget; \n  const dx = (e.clientX - lastPan.x) * (viewBox.w / svg.clientWidth);\n  const dy = (e.clientY - lastPan.y) * (viewBox.h / svg.clientHeight);\n  viewBox.x -= dx;\n  viewBox.y -= dy;\n  lastPan.x = e.clientX;\n  lastPan.y = e.clientY;\n}\nexport function onPanEnd() { isPanning.value = false; }\n\n// ---------- WHEEL (zoom at cursor) ----------\nexport const onWheel = (event) => {\n  const svg = event.currentTarget;\n  const rect = svg.getBoundingClientRect();\n  const mouseX = event.clientX - rect.left;\n  const mouseY = event.clientY - rect.top;\n  const scaleFactor = event.deltaY < 0 ? 0.9 : 1.1; // zoom in when scroll up\n  const worldMx = viewBox.x + (mouseX / rect.width) * viewBox.w;\n  const worldMy = viewBox.y + (mouseY / rect.height) * viewBox.h;\n\n  // new size\n  const newW = viewBox.w * scaleFactor;\n  const newH = viewBox.h * scaleFactor;\n  // keep the zoom centered on mouse\n  viewBox.x = worldMx - (mouseX / rect.width) * newW;\n  viewBox.y = worldMy - (mouseY / rect.height) * newH;\n  viewBox.w = newW;\n  viewBox.h = newH;\n};\n\n// ---------- ZOOM TO NODE (smooth-ish) ----------\nexport function zoomToNode(node, scale = 2, duration = 300) {\n  const start = { x: viewBox.x, y: viewBox.y, w: viewBox.w, h: viewBox.h };\n  const cx = node.x, cy = node.y;\n  const targetW = initView.w / scale;\n  const targetH = initView.h / scale;\n  const target = { x: cx - targetW / 2, y: cy - targetH / 2, w: targetW, h: targetH };\n  const t0 = performance.now();\n  function step(t) {\n    const p = Math.min(1, (t - t0) / duration);\n    const e = 1 - Math.pow(1 - p, 2); // easeOutQuad\n    viewBox.x = start.x + (target.x - start.x) * e;\n    viewBox.y = start.y + (target.y - start.y) * e;\n    viewBox.w = start.w + (target.w - start.w) * e;\n    viewBox.h = start.h + (target.h - start.h) * e;\n    if (p < 1) requestAnimationFrame(step);\n  }\n  requestAnimationFrame(step);\n}\n\n\nexport function useCanvas() {\n    return {\n        viewBox, isPanning,\n        onPanStart, onPanMove, onPanEnd, onWheel,\n        svgToWorld, worldToScreen, zoomToNode,\n    }\n}","// src/composables/useNodes.js\nimport { reactive, ref } from 'vue';\nimport { nodes, territories, autoSave } from './useState.js';\nimport { svgToWorld, viewBox } from './useCanvas.js';\n\n// Territory boundary constraints\nconst NODE_WIDTH = 180;\nconst NODE_HEIGHT = 80;\nconst TERRITORY_PADDING = 20;\n\n/**\n * @typedef {Object} DragState\n * @property {boolean} active - Is dragging active\n * @property {string|null} id - Node being dragged\n * @property {number} ox - Offset X\n * @property {number} oy - Offset Y\n */\n\n// --- NODE/SELECTION STATE ---\nconst selectedNode = ref(null);\nconst quickNodeLabel = ref('');\nconst editingNode = ref(null);\n\n/** @type {import('vue').UnwrapRef<DragState>} */\nconst dragging = reactive({ active: false, id: null, ox: 0, oy: 0 });\n\n// ---------- NODE / EDGE CRUD helpers ----------\n/**\n * Find node by ID\n * @param {string} id - Node ID\n * @returns {import('./useState').Node|undefined}\n */\nexport function nodeById(id) {\n  return nodes.find(n => n.id === id);\n}\n\n/**\n * Select a node for editing\n * @param {import('./useState').Node} n - Node to select\n */\nexport function selectNode(n) {\n  selectedNode.value = n;\n  editingNode.value = n;\n}\n\n/**\n * Deselect current node\n */\nexport function deselectNode() {\n  selectedNode.value = null;\n  editingNode.value = null;\n}\n\n/**\n * Quick add a new node at viewport center\n */\nexport function quickAddNode() {\n  const label = quickNodeLabel.value.trim();\n  if (!label) {\n    console.warn('Cannot add node with empty label');\n    return;\n  }\n\n  const id = crypto.randomUUID();\n  const newNode = {\n    id,\n    label,\n    x: viewBox.x + viewBox.w / 2,\n    y: viewBox.y + viewBox.h / 2,\n    territoryId: null,\n    note: '',\n    status: 'todo',\n    timestamp: Date.now()\n  };\n\n  nodes.push(newNode);\n  quickNodeLabel.value = '';\n}\n\n// ---------- NODE DRAGGING (Uses svgToWorld from useCanvas) ----------\nexport const onNodeDragStart = (e, node) => {\n  e.stopPropagation(); \n  const p = svgToWorld(e); // <-- CRITICAL: Uses imported helper\n  dragging.active = true;\n  dragging.id = node.id;\n  dragging.ox = p.x - node.x;\n  dragging.oy = p.y - node.y;\n  window.addEventListener('mousemove', onNodeDragMove);\n  window.addEventListener('mouseup', onNodeDragEnd);\n};\n\nexport const onNodeDragMove = (e) => {\n  if (!dragging.active || !dragging.id) return;\n  const p = svgToWorld(e);\n  const n = nodes.find(x => x.id === dragging.id);\n  if (!n) return;\n\n  // Calculate new position\n  let newX = p.x - dragging.ox;\n  let newY = p.y - dragging.oy;\n\n  // Find which territory this node belongs to\n  const territory = territories.find(t =>\n    t.nodeIds && t.nodeIds.includes(n.id)\n  );\n\n  // Constrain to territory bounds if node is in a territory\n  if (territory) {\n    // Min bounds (left, top)\n    const minX = territory.x + TERRITORY_PADDING;\n    const minY = territory.y + 60 + TERRITORY_PADDING; // 60 = header height\n\n    // Max bounds (right, bottom) - account for node size\n    const maxX = territory.x + territory.w - NODE_WIDTH / 2 - TERRITORY_PADDING;\n    const maxY = territory.y + territory.h - NODE_HEIGHT / 2 - TERRITORY_PADDING;\n\n    // Clamp position\n    newX = Math.max(minX + NODE_WIDTH / 2, Math.min(newX, maxX));\n    newY = Math.max(minY + NODE_HEIGHT / 2, Math.min(newY, maxY));\n\n    // Visual feedback when hitting boundary\n    const isAtBoundary =\n      newX !== (p.x - dragging.ox) || newY !== (p.y - dragging.oy);\n\n    if (isAtBoundary && !n._boundaryWarned) {\n      console.log(`🚧 Node \"${n.label}\" constrained to territory \"${territory.label}\"`);\n      n._boundaryWarned = true; // Prevent log spam\n    }\n  }\n\n  n.x = newX;\n  n.y = newY;\n};\n\nexport const onNodeDragEnd = (e) => {\n  // Clear boundary warning flag\n  if (dragging.id) {\n    const n = nodes.find(x => x.id === dragging.id);\n    if (n) delete n._boundaryWarned;\n  }\n\n  dragging.active = false;\n  dragging.id = null;\n  window.removeEventListener('mousemove', onNodeDragMove);\n  window.removeEventListener('mouseup', onNodeDragEnd);\n\n  // Auto-save after drag\n  autoSave();\n};\n\nexport function useNodes() {\n    return {\n        selectedNode, quickNodeLabel, editingNode, dragging,\n        nodeById, selectNode, deselectNode, quickAddNode,\n        onNodeDragStart, onNodeDragMove, onNodeDragEnd,\n    }\n}\n\n","<template>\n  <div class=\"app\">\n    <!-- Sidebar: chat & analysis -->\n    <aside class=\"sidebar\">\n      <div>\n        <h2>Character Chat ▸ Needs</h2>\n        <textarea\n          v-model=\"chatInput\"\n          :disabled=\"isGenerating\"\n          placeholder=\"e.g. I want to prepare for IELTS in 8 weeks; I struggle with timing and writing Task 1...\"\n        ></textarea>\n        <div class=\"row\">\n          <button class=\"btn\" @click=\"runAnalysis\" :disabled=\"isGenerating\">\n            Analyze ▸ SWOT\n          </button>\n          <button class=\"btn\" @click=\"generateMap\" :disabled=\"isGenerating\">\n            <span v-if=\"!isGenerating\">Generate Map</span>\n            <span v-else class=\"spinner-row\">\n              <span class=\"spinner\"></span>\n              Generating...\n            </span>\n          </button>\n        </div>\n      </div>\n\n      <div>\n        <h2>SWOT (editable)</h2>\n        <label class=\"muted\">Strengths</label>\n        <textarea v-model=\"swot.strengths\"></textarea>\n        <label class=\"muted\">Weaknesses</label>\n        <textarea v-model=\"swot.weaknesses\"></textarea>\n        <label class=\"muted\">Opportunities</label>\n        <textarea v-model=\"swot.opportunities\"></textarea>\n        <label class=\"muted\">Threats</label>\n        <textarea v-model=\"swot.threats\"></textarea>\n        <div class=\"row\">\n          <button class=\"btn\" @click=\"handleSave\">Save</button>\n          <button class=\"btn\" @click=\"handleLoad\">Load</button>\n          <button class=\"btn\" @click=\"handleReset\">Reset</button>\n        </div>\n      </div>\n    </aside>\n\n    <!-- Main: toolbar + canvas -->\n    <main class=\"main\">\n      <div class=\"toolbar\">\n        <span class=\"badge\">Zoom: {{ zoomPercentage }}%</span>\n        <button class=\"btn\" @click=\"() => zoomAtCenter(1.2)\">+</button>\n        <button class=\"btn\" @click=\"() => zoomAtCenter(1 / 1.2)\">−</button>\n        <button class=\"btn\" @click=\"centerView\">Center</button>\n        <input\n          type=\"text\"\n          placeholder=\"Quick add node (Label)\"\n          v-model=\"quickNodeLabel\"\n          @keydown.enter=\"quickAddNode\"\n        />\n        <button class=\"btn\" @click=\"quickAddNode\">Add Node</button>\n        <span class=\"muted\">Click+Drag to pan · Scroll to zoom · Drag nodes</span>\n      </div>\n\n      <section class=\"canvas-wrap\">\n        <svg\n          :class=\"{ dragging: isPanning }\"\n          :viewBox=\"`${viewBox.x} ${viewBox.y} ${viewBox.w} ${viewBox.h}`\"\n          @mousedown=\"onPanStart\"\n          @mousemove=\"onPanMove\"\n          @mouseup=\"onPanEnd\"\n          @mouseleave=\"onPanEnd\"\n          @wheel.prevent=\"onWheel\"\n        >\n          <!-- defs -->\n          <defs>\n            <marker\n              id=\"arrow\"\n              viewBox=\"0 0 10 10\"\n              refX=\"10\"\n              refY=\"5\"\n              markerWidth=\"6\"\n              markerHeight=\"6\"\n              orient=\"auto-start-reverse\"\n            >\n              <path d=\"M 0 0 L 10 5 L 0 10 z\" fill=\"#b9bfd2\"></path>\n            </marker>\n          </defs>\n\n          <!-- territories -->\n          <g v-for=\"t in territories\" :key=\"t.id\">\n            <rect\n              class=\"territory\"\n              :x=\"t.x\"\n              :y=\"t.y\"\n              :rx=\"12\"\n              :ry=\"12\"\n              :width=\"t.w\"\n              :height=\"t.h\"\n            ></rect>\n            <text class=\"territory-title\" :x=\"t.x + 10\" :y=\"t.y + 18\">\n              {{ t.label }}\n            </text>\n          </g>\n\n          <!-- edges -->\n          <g>\n            <line\n              v-for=\"e in edges\"\n              :key=\"e.id\"\n              class=\"edge\"\n              :x1=\"nodeById(e.source)?.x || 0\"\n              :y1=\"nodeById(e.source)?.y || 0\"\n              :x2=\"nodeById(e.target)?.x || 0\"\n              :y2=\"nodeById(e.target)?.y || 0\"\n            />\n          </g>\n\n          <!-- nodes -->\n          <g\n            v-for=\"n in nodes\"\n            :key=\"n.id\"\n            @mousedown.stop=\"(e) => onNodeDragStart(e, n)\"\n            @dblclick.stop=\"() => selectNode(n)\"\n            @contextmenu.prevent=\"(e) => onNodeRightClick(e, n)\"\n          >\n            <rect\n              :class=\"['node', selectedNode && selectedNode.id === n.id ? 'selected' : '']\"\n              :x=\"n.x - 60\"\n              :y=\"n.y - 22\"\n              rx=\"10\"\n              ry=\"10\"\n              width=\"120\"\n              height=\"44\"\n            />\n            <text\n              class=\"node-label\"\n              :x=\"n.x\"\n              :y=\"n.y + 4\"\n              text-anchor=\"middle\"\n            >\n              {{ n.label }}\n            </text>\n          </g>\n        </svg>\n\n        <!-- Inspector Panel (when node selected) -->\n        <div v-if=\"selectedNode\" class=\"inspector\">\n          <h3>{{ selectedNode.label }}</h3>\n          <input\n            v-model=\"selectedNode.label\"\n            placeholder=\"Node Label\"\n            @input=\"handleNodeUpdate\"\n          />\n          <textarea\n            v-model=\"selectedNode.note\"\n            placeholder=\"Notes...\"\n            @input=\"handleNodeUpdate\"\n          ></textarea>\n          <select v-model=\"selectedNode.status\" @change=\"handleNodeUpdate\">\n            <option value=\"todo\">To Do</option>\n            <option value=\"in-progress\">In Progress</option>\n            <option value=\"done\">Done</option>\n          </select>\n          <button class=\"btn\" @click=\"deselectNode\">Close</button>\n        </div>\n      </section>\n    </main>\n\n    <!-- Custom Context Menu -->\n    <div\n      v-if=\"contextMenu.visible\"\n      class=\"context-menu\"\n      :style=\"{\n        left: contextMenu.x + 'px',\n        top: contextMenu.y + 'px'\n      }\"\n    >\n      <button class=\"context-menu-item danger\" @click=\"handleDeleteNode\">\n        <span class=\"icon\">🗑️</span>\n        Delete \"{{ contextMenu.node?.label }}\"\n      </button>\n      <button class=\"context-menu-item\" @click=\"closeContextMenu\">\n        Cancel\n      </button>\n    </div>\n\n    <!-- Error Display -->\n    <div v-if=\"error\" class=\"error-banner\" @click=\"clearError\">\n      {{ error }} (click to dismiss)\n    </div>\n  </div>\n</template>\n\n<script>\nimport { ref, computed, onMounted, onErrorCaptured } from 'vue';\nimport { useState } from './composables/useState.js';\nimport { useCanvas } from './composables/useCanvas.js';\nimport { useNodes } from './composables/useNodes.js';\n\nexport default {\n  name: 'App',\n  setup() {\n    // Error handling\n    const error = ref(null);\n\n    const handleError = (err, context = '') => {\n      console.error(`[App Error] ${context}:`, err);\n      error.value = `${context}: ${err.message || err}`;\n      setTimeout(() => { error.value = null; }, 5000);\n    };\n\n    const clearError = () => { error.value = null; };\n\n    // Context menu state\n    const contextMenu = ref({\n      visible: false,\n      x: 0,\n      y: 0,\n      node: null\n    });\n\n    // Capture component errors\n    onErrorCaptured((err, instance, info) => {\n      handleError(err, `Component error (${info})`);\n      return false; // Prevent error propagation\n    });\n\n    // Execute composables with error handling\n    let stateComposable, canvasComposable, nodesComposable;\n\n    try {\n      stateComposable = useState();\n      canvasComposable = useCanvas();\n      nodesComposable = useNodes();\n    } catch (err) {\n      handleError(err, 'Composable initialization failed');\n      // Provide fallbacks\n      stateComposable = { territories: ref([]), nodes: ref([]), edges: ref([]), chatInput: ref(''), swot: ref({}) };\n      canvasComposable = { viewBox: ref({ x: 0, y: 0, w: 1600, h: 900 }), isPanning: ref(false) };\n      nodesComposable = { selectedNode: ref(null), quickNodeLabel: ref('') };\n    }\n\n    // Destructure composables\n    const {\n      territories, nodes, edges, chatInput, swot, isGenerating,\n      runAnalysis, generateMap, saveSnapshot, loadSnapshot, autoLoad, deleteNode\n    } = stateComposable;\n\n    const {\n      viewBox, isPanning,\n      onPanStart, onPanMove, onPanEnd, onWheel,\n      svgToWorld, worldToScreen, zoomToNode\n    } = canvasComposable;\n\n    const {\n      selectedNode, quickNodeLabel, editingNode, dragging,\n      nodeById, selectNode, deselectNode, quickAddNode,\n      onNodeDragStart, onNodeDragMove, onNodeDragEnd\n    } = nodesComposable;\n\n    // Computed zoom percentage\n    const zoomPercentage = computed(() => {\n      const initW = 1600; // Default initial width\n      return (100 * (initW / viewBox.w)).toFixed(0);\n    });\n\n    // Enhanced action handlers with error handling\n    const handleSave = () => {\n      try {\n        saveSnapshot(`manual-${Date.now()}`);\n        console.log('✓ State saved successfully');\n      } catch (err) {\n        handleError(err, 'Save failed');\n      }\n    };\n\n    const handleLoad = () => {\n      try {\n        const index = 0; // Load latest snapshot\n        loadSnapshot(index);\n        console.log('✓ State loaded successfully');\n      } catch (err) {\n        handleError(err, 'Load failed');\n      }\n    };\n\n    const handleReset = () => {\n      try {\n        if (confirm('Reset all data? This cannot be undone.')) {\n          territories.splice(0);\n          nodes.splice(0);\n          edges.splice(0);\n          chatInput.value = '';\n          swot.strengths = '';\n          swot.weaknesses = '';\n          swot.opportunities = '';\n          swot.threats = '';\n          console.log('✓ Reset complete');\n        }\n      } catch (err) {\n        handleError(err, 'Reset failed');\n      }\n    };\n\n    const handleNodeUpdate = () => {\n      // Trigger reactivity and optionally auto-save\n      console.log('Node updated:', selectedNode.value);\n    };\n\n    // Handle right-click on node - show context menu\n    const onNodeRightClick = (event, node) => {\n      try {\n        event.preventDefault();\n        event.stopPropagation();\n\n        // Position context menu at cursor\n        contextMenu.value = {\n          visible: true,\n          x: event.clientX,\n          y: event.clientY,\n          node: node\n        };\n      } catch (err) {\n        handleError(err, 'Context menu failed');\n      }\n    };\n\n    // Close context menu\n    const closeContextMenu = () => {\n      contextMenu.value.visible = false;\n      contextMenu.value.node = null;\n    };\n\n    // Handle delete from context menu\n    const handleDeleteNode = () => {\n      try {\n        const node = contextMenu.value.node;\n        if (!node) return;\n\n        // Close inspector if this node is selected\n        if (selectedNode.value && selectedNode.value.id === node.id) {\n          deselectNode();\n        }\n\n        // Delete the node\n        const success = deleteNode(node.id);\n\n        if (!success) {\n          handleError(new Error('Failed to delete node'), 'Delete failed');\n        }\n\n        // Close context menu\n        closeContextMenu();\n      } catch (err) {\n        handleError(err, 'Delete node failed');\n      }\n    };\n\n    // Zoom controls\n    const zoomAtCenter = (factor) => {\n      try {\n        const cx = viewBox.x + viewBox.w / 2;\n        const cy = viewBox.y + viewBox.h / 2;\n        const newW = viewBox.w / factor;\n        const newH = viewBox.h / factor;\n        viewBox.x = cx - newW / 2;\n        viewBox.y = cy - newH / 2;\n        viewBox.w = newW;\n        viewBox.h = newH;\n      } catch (err) {\n        handleError(err, 'Zoom failed');\n      }\n    };\n\n    const centerView = () => {\n      try {\n        viewBox.x = 0;\n        viewBox.y = 0;\n        viewBox.w = 1600;\n        viewBox.h = 900;\n      } catch (err) {\n        handleError(err, 'Center view failed');\n      }\n    };\n\n    // Mount lifecycle\n    onMounted(() => {\n      try {\n        // Try to load saved state first\n        const loaded = autoLoad && typeof autoLoad === 'function' && autoLoad();\n\n        // If no saved state, generate initial demo map\n        if (!loaded && generateMap && typeof generateMap === 'function') {\n          console.log('No saved state, generating initial map...');\n          generateMap();\n        }\n\n        // Global click handler to close context menu\n        const handleGlobalClick = (e) => {\n          // Check if click is outside context menu\n          if (contextMenu.value.visible && !e.target.closest('.context-menu')) {\n            closeContextMenu();\n          }\n        };\n\n        document.addEventListener('click', handleGlobalClick);\n\n        // Cleanup on unmount\n        return () => {\n          document.removeEventListener('click', handleGlobalClick);\n        };\n      } catch (err) {\n        handleError(err, 'Initialization failed');\n      }\n    });\n\n    // Return everything to template\n    return {\n      // State\n      chatInput,\n      swot,\n      isGenerating,\n      territories,\n      nodes,\n      edges,\n      selectedNode,\n      quickNodeLabel,\n      editingNode,\n      contextMenu,\n\n      // View\n      viewBox,\n      isPanning,\n      zoomPercentage,\n\n      // Actions\n      runAnalysis,\n      generateMap,\n      handleSave,\n      handleLoad,\n      handleReset,\n      handleNodeUpdate,\n      onNodeRightClick,\n      closeContextMenu,\n      handleDeleteNode,\n      onWheel,\n      onPanStart,\n      onPanMove,\n      onPanEnd,\n      onNodeDragStart,\n      onNodeDragMove,\n      onNodeDragEnd,\n      nodeById,\n      selectNode,\n      deselectNode,\n      quickAddNode,\n      zoomToNode,\n      zoomAtCenter,\n      centerView,\n\n      // Error handling\n      error,\n      clearError\n    };\n  }\n};\n</script>\n\n<style scoped>\n.app {\n  display: grid;\n  grid-template-columns: 320px 1fr;\n  height: 100vh;\n}\n\n.sidebar {\n  border-right: 1px solid #eee;\n  padding: 14px;\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n  overflow-y: auto;\n}\n\n.sidebar h2 {\n  margin: 0 0 6px;\n  font-size: 18px;\n}\n\n.sidebar textarea {\n  width: 100%;\n  min-height: 120px;\n  padding: 10px;\n  border: 1px solid #ddd;\n  border-radius: 8px;\n  resize: vertical;\n  font-family: inherit;\n}\n\n.sidebar .btn {\n  padding: 10px 12px;\n  border: none;\n  border-radius: 10px;\n  background: #111;\n  color: #fff;\n  cursor: pointer;\n  transition: background 0.2s;\n  position: relative;\n}\n\n.sidebar .btn:hover:not(:disabled) {\n  background: #333;\n}\n\n.sidebar .btn:disabled {\n  opacity: 0.6;\n  cursor: not-allowed;\n}\n\n.spinner-row {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.spinner {\n  width: 14px;\n  height: 14px;\n  border: 2px solid rgba(255, 255, 255, 0.3);\n  border-top-color: #fff;\n  border-radius: 50%;\n  animation: spin 0.8s linear infinite;\n}\n\n@keyframes spin {\n  to { transform: rotate(360deg); }\n}\n\n.sidebar .row {\n  display: flex;\n  gap: 8px;\n}\n\n.main {\n  display: grid;\n  grid-template-rows: 48px 1fr;\n}\n\n.toolbar {\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  padding: 8px 12px;\n  border-bottom: 1px solid #eee;\n}\n\n.toolbar .btn {\n  padding: 6px 10px;\n  border-radius: 8px;\n  border: 1px solid #ddd;\n  background: #fafafa;\n  cursor: pointer;\n  transition: background 0.2s;\n}\n\n.toolbar .btn:hover {\n  background: #f0f0f0;\n}\n\n.toolbar input[type=\"text\"] {\n  padding: 6px 8px;\n  border: 1px solid #ddd;\n  border-radius: 8px;\n  min-width: 200px;\n  font-family: inherit;\n}\n\n.canvas-wrap {\n  position: relative;\n  background: #fbfbfd;\n}\n\nsvg {\n  width: 100%;\n  height: calc(100vh - 48px);\n  display: block;\n  cursor: grab;\n}\n\nsvg.dragging {\n  cursor: grabbing;\n}\n\n.territory {\n  fill: #f6f7fb;\n  stroke: #e5e7f0;\n  stroke-width: 1.5;\n}\n\n.territory-title {\n  font-size: 13px;\n  fill: #556;\n}\n\n.node {\n  fill: #fff;\n  stroke: #c8cdda;\n  stroke-width: 1.5;\n  filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.08));\n  cursor: move;\n  transition: stroke 0.2s;\n}\n\n.node:hover {\n  stroke: #8b90a8;\n}\n\n.node.selected {\n  stroke: #4f46e5;\n  stroke-width: 2;\n}\n\n.node-label {\n  font-size: 12px;\n  fill: #334;\n  pointer-events: none;\n}\n\n.edge {\n  stroke: #b9bfd2;\n  stroke-width: 1.25;\n  marker-end: url(#arrow);\n}\n\n.inspector {\n  position: absolute;\n  right: 18px;\n  top: 18px;\n  width: 300px;\n  background: #fff;\n  border: 1px solid #eee;\n  border-radius: 12px;\n  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.06);\n  padding: 12px;\n  display: grid;\n  gap: 10px;\n}\n\n.inspector h3 {\n  margin: 0;\n  font-size: 16px;\n}\n\n.inspector input,\n.inspector textarea,\n.inspector select {\n  width: 100%;\n  padding: 8px;\n  border: 1px solid #ddd;\n  border-radius: 8px;\n  font-family: inherit;\n}\n\n.inspector .btn {\n  padding: 8px 12px;\n  border: none;\n  border-radius: 8px;\n  background: #111;\n  color: #fff;\n  cursor: pointer;\n}\n\n.badge {\n  display: inline-flex;\n  align-items: center;\n  gap: 6px;\n  padding: 4px 8px;\n  border: 1px solid #ddd;\n  border-radius: 999px;\n  font-size: 12px;\n  background: #fff;\n}\n\n.muted {\n  color: #667085;\n  font-size: 12px;\n}\n\n.error-banner {\n  position: fixed;\n  bottom: 20px;\n  left: 50%;\n  transform: translateX(-50%);\n  background: #fee;\n  color: #c33;\n  padding: 12px 20px;\n  border-radius: 8px;\n  border: 1px solid #fcc;\n  cursor: pointer;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n  z-index: 1000;\n  animation: slideUp 0.3s ease;\n}\n\n@keyframes slideUp {\n  from {\n    opacity: 0;\n    transform: translateX(-50%) translateY(20px);\n  }\n  to {\n    opacity: 1;\n    transform: translateX(-50%) translateY(0);\n  }\n}\n\n/* Context Menu */\n.context-menu {\n  position: fixed;\n  background: white;\n  border: 1px solid #e5e7eb;\n  border-radius: 8px;\n  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15), 0 4px 8px rgba(0, 0, 0, 0.08);\n  padding: 4px;\n  min-width: 200px;\n  z-index: 9999;\n  animation: contextMenuSlide 0.15s ease-out;\n}\n\n@keyframes contextMenuSlide {\n  from {\n    opacity: 0;\n    transform: translateY(-8px) scale(0.95);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0) scale(1);\n  }\n}\n\n.context-menu-item {\n  width: 100%;\n  padding: 10px 14px;\n  border: none;\n  background: transparent;\n  text-align: left;\n  cursor: pointer;\n  border-radius: 6px;\n  font-size: 14px;\n  font-family: inherit;\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  transition: background 0.15s ease;\n  color: #1f2937;\n}\n\n.context-menu-item:hover {\n  background: #f3f4f6;\n}\n\n.context-menu-item.danger {\n  color: #dc2626;\n}\n\n.context-menu-item.danger:hover {\n  background: #fef2f2;\n}\n\n.context-menu-item .icon {\n  font-size: 16px;\n  width: 20px;\n  text-align: center;\n}\n</style>\n","/**\n * Main entry point for Character Canvas Vue application\n * Initializes Vue 3 app with composable architecture\n */\nimport { createApp } from 'vue';\nimport App from './App.vue';\nimport './style.css';\n\n// Global error handler\nconst handleGlobalError = (err, instance, info) => {\n  console.error('Global Error:', err);\n  console.error('Component:', instance);\n  console.error('Error Info:', info);\n\n  // You can send to error tracking service here\n  // Example: Sentry.captureException(err);\n};\n\n// Create and configure Vue app\nconst app = createApp(App);\n\n// Register global error handler\napp.config.errorHandler = handleGlobalError;\n\n// Production tip (disable in production)\napp.config.performance = true;\n\n// Mount app\ntry {\n  app.mount('#app');\n  console.log('✓ Character Canvas initialized successfully');\n} catch (error) {\n  console.error('Failed to mount Vue app:', error);\n  document.querySelector('#app').innerHTML = `\n    <div style=\"padding: 20px; font-family: system-ui;\">\n      <h1 style=\"color: #c33;\">Application Failed to Load</h1>\n      <p>An error occurred while initializing the application.</p>\n      <pre style=\"background: #f5f5f5; padding: 10px; border-radius: 4px; overflow: auto;\">\n${error.stack || error.message}\n      </pre>\n      <button onclick=\"location.reload()\" style=\"padding: 10px 20px; border-radius: 6px; border: none; background: #111; color: #fff; cursor: pointer;\">\n        Reload Page\n      </button>\n    </div>\n  `;\n}\n"],"names":["territories","reactive","nodes","edges","chatInput","ref","isGenerating","swot","AUTO_SAVE_KEY","autoSave","state","error","autoLoad","saved","t","n","e","saveSnapshot","name","raw","history","data","loadSnapshot","index","snap","TERRITORY_PADDING","TERRITORY_HEADER","NODE_WIDTH","NODE_HEIGHT","NODE_SPACING_X","NODE_SPACING_Y","COLS_PER_TERRITORY","TERRITORY_SPACING","TERRITORY_COLS","calculateTerritoryDimensions","nodeCount","rows","width","height","positionNodeInTerritory","node","territory","indexInTerritory","col","row","x","y","maxX","maxY","finalX","finalY","deleteNode","nodeId","nodeIndex","edgesToRemove","edge","edgeIndex","idIndex","runAnalysis","generateMap","response","errorData","errorMessage","_a","mapData","llmNodes","llmEdges","dimensions","nodesPositioned","nodesOutside","position","userMessage","useState","initView","viewBox","isPanning","lastPan","svgToWorld","svg","r","px","py","worldToScreen","sx","sy","onPanStart","onPanMove","dx","dy","onPanEnd","onWheel","event","rect","mouseX","mouseY","scaleFactor","worldMx","worldMy","newW","newH","zoomToNode","scale","duration","start","cx","cy","targetW","targetH","target","t0","step","p","useCanvas","selectedNode","quickNodeLabel","editingNode","dragging","nodeById","id","selectNode","deselectNode","quickAddNode","label","newNode","onNodeDragStart","onNodeDragMove","onNodeDragEnd","newX","newY","minX","minY","useNodes","_sfc_main","handleError","err","context","clearError","contextMenu","onErrorCaptured","instance","info","stateComposable","canvasComposable","nodesComposable","zoomPercentage","computed","handleSave","handleLoad","handleReset","handleNodeUpdate","onNodeRightClick","closeContextMenu","handleDeleteNode","zoomAtCenter","factor","centerView","onMounted","handleGlobalClick","_hoisted_1","_hoisted_2","_hoisted_4","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_openBlock","_createElementBlock","_createElementVNode","_cache","$setup","$event","args","_hoisted_5","_hoisted_8","_vModelText","_toDisplayString","_Fragment","_renderList","_hoisted_16","_b","_c","_d","_withModifiers","_normalizeClass","_hoisted_20","_hoisted_21","_vModelSelect","_normalizeStyle","_createTextVNode","handleGlobalError","app","createApp","App"],"mappings":"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"}