{"version":3,"file":"index-HAv4h4zh.js","sources":["../../src/composables/usePersistence.js","../../src/composables/useState.js","../../src/composables/useCanvas.js","../../src/composables/useNodes.js","../../src/App.vue","../../src/main.js"],"sourcesContent":["// src/composables/usePersistence.js\n// Robust data persistence with debouncing, backup rotation, validation\n\nconst PRIMARY_KEY = 'hikki-canvas-state';\nconst BACKUP_KEY = 'hikki-canvas-state-backup';\nconst MAX_DATA_SIZE = 50 * 1024 * 1024; // 50MB limit\n\nlet saveTimeout = null;\n\n/**\n * Validate data structure and size\n * @param {Object} data - Data to validate\n * @returns {boolean} True if valid\n */\nfunction validateData(data) {\n  try {\n    // Check required structure\n    if (!data || typeof data !== 'object') {\n      console.error('üö´ Validation failed: Data is not an object');\n      return false;\n    }\n\n    if (!Array.isArray(data.territories) || !Array.isArray(data.nodes) || !Array.isArray(data.edges)) {\n      console.error('üö´ Validation failed: Missing required arrays');\n      return false;\n    }\n\n    // Check size\n    const jsonStr = JSON.stringify(data);\n    const sizeBytes = new Blob([jsonStr]).size;\n\n    if (sizeBytes > MAX_DATA_SIZE) {\n      console.error(`üö´ Validation failed: Data exceeds ${MAX_DATA_SIZE / 1024 / 1024}MB limit`);\n      return false;\n    }\n\n    console.log(`‚úì Validation passed (${(sizeBytes / 1024).toFixed(2)}KB)`);\n    return true;\n  } catch (error) {\n    console.error('üö´ Validation error:', error);\n    return false;\n  }\n}\n\n/**\n * Save data to localStorage with backup rotation\n * @param {Object} data - Data to save\n * @returns {boolean} Success status\n */\nfunction saveToStorage(data) {\n  try {\n    if (!validateData(data)) {\n      return false;\n    }\n\n    const jsonStr = JSON.stringify(data);\n\n    // Rotate: primary ‚Üí backup, new ‚Üí primary\n    const existingPrimary = localStorage.getItem(PRIMARY_KEY);\n    if (existingPrimary) {\n      localStorage.setItem(BACKUP_KEY, existingPrimary);\n      console.log('üîÑ Rotated primary to backup');\n    }\n\n    localStorage.setItem(PRIMARY_KEY, jsonStr);\n    console.log(`üíæ Saved to primary storage (${data.nodes.length} nodes, ${data.edges.length} edges)`);\n    return true;\n  } catch (error) {\n    console.error('‚ùå Save failed:', error);\n    return false;\n  }\n}\n\n/**\n * Load data from localStorage with fallback to backup\n * @returns {Object|null} Loaded data or null\n */\nfunction loadFromStorage() {\n  try {\n    // Try primary first\n    let jsonStr = localStorage.getItem(PRIMARY_KEY);\n\n    if (jsonStr) {\n      try {\n        const data = JSON.parse(jsonStr);\n        if (validateData(data)) {\n          console.log(`‚úÖ Loaded from primary storage (${data.nodes.length} nodes)`);\n          return data;\n        }\n      } catch (parseError) {\n        console.warn('‚ö†Ô∏è Primary storage corrupted, trying backup...');\n      }\n    }\n\n    // Fallback to backup\n    jsonStr = localStorage.getItem(BACKUP_KEY);\n    if (jsonStr) {\n      try {\n        const data = JSON.parse(jsonStr);\n        if (validateData(data)) {\n          console.log(`‚úÖ Recovered from backup storage (${data.nodes.length} nodes)`);\n          // Restore backup to primary\n          saveToStorage(data);\n          return data;\n        }\n      } catch (parseError) {\n        console.error('‚ùå Backup storage also corrupted');\n      }\n    }\n\n    console.log('‚ÑπÔ∏è No saved data found');\n    return null;\n  } catch (error) {\n    console.error('‚ùå Load failed:', error);\n    return null;\n  }\n}\n\n/**\n * Debounced autosave - saves after 500ms of inactivity\n * @param {Object} data - Data to save\n */\nexport function debouncedAutoSave(data) {\n  // Clear existing timeout\n  if (saveTimeout) {\n    clearTimeout(saveTimeout);\n  }\n\n  // Set new timeout\n  saveTimeout = setTimeout(() => {\n    console.log('‚è±Ô∏è Debounced save triggered');\n    saveToStorage(data);\n  }, 500);\n}\n\n/**\n * Immediate save (for critical operations like delete)\n * @param {Object} data - Data to save\n */\nexport function immediateAutoSave(data) {\n  // Clear any pending debounced save\n  if (saveTimeout) {\n    clearTimeout(saveTimeout);\n    saveTimeout = null;\n  }\n\n  console.log('‚ö° Immediate save triggered');\n  return saveToStorage(data);\n}\n\n/**\n * Load saved state\n * @returns {Object|null} Loaded data or null\n */\nexport function loadSavedState() {\n  return loadFromStorage();\n}\n\n/**\n * Export data as downloadable JSON file\n * @param {Object} data - Data to export\n */\nexport function exportData(data) {\n  try {\n    if (!validateData(data)) {\n      throw new Error('Invalid data structure');\n    }\n\n    const jsonStr = JSON.stringify(data, null, 2);\n    const blob = new Blob([jsonStr], { type: 'application/json' });\n    const url = URL.createObjectURL(blob);\n\n    const timestamp = new Date().toISOString().split('T')[0];\n    const filename = `hikki-notes-${timestamp}.json`;\n\n    const link = document.createElement('a');\n    link.href = url;\n    link.download = filename;\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n    URL.revokeObjectURL(url);\n\n    console.log(`üì• Exported data as ${filename}`);\n  } catch (error) {\n    console.error('‚ùå Export failed:', error);\n    throw error;\n  }\n}\n\n/**\n * Import data from JSON file\n * @param {File} file - File to import\n * @returns {Promise<Object>} Imported data\n */\nexport function importData(file) {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n\n    reader.onload = (e) => {\n      try {\n        const data = JSON.parse(e.target.result);\n\n        if (!validateData(data)) {\n          reject(new Error('Invalid file structure'));\n          return;\n        }\n\n        console.log(`üì§ Imported data (${data.nodes.length} nodes, ${data.edges.length} edges)`);\n        resolve(data);\n      } catch (error) {\n        console.error('‚ùå Import failed:', error);\n        reject(error);\n      }\n    };\n\n    reader.onerror = () => {\n      reject(new Error('File read failed'));\n    };\n\n    reader.readAsText(file);\n  });\n}\n","\nimport { reactive, ref } from 'vue';\nimport placeNodes from '../services/nodePositioning.js';\n\n/**\n * @typedef {Object} Territory\n * @property {string} id - Unique identifier\n * @property {string} label - Display name\n * @property {number} x - X coordinate\n * @property {number} y - Y coordinate\n * @property {number} w - Width\n * @property {number} h - Height\n */\n\n/**\n * @typedef {Object} Node\n * @property {string} id - Unique identifier\n * @property {string} label - Display name\n * @property {number} x - X coordinate\n * @property {number} y - Y coordinate\n * @property {string|null} territoryId - Parent territory ID\n * @property {string} note - User notes\n * @property {'todo'|'in-progress'|'done'} status - Task status\n * @property {number} timestamp - Creation time\n */\n\n/**\n * @typedef {Object} Edge\n * @property {string} id - Unique identifier\n * @property {string} source - Source node ID\n * @property {string} target - Target node ID\n */\n\n/**\n * @typedef {Object} SWOT\n * @property {string} strengths\n * @property {string} weaknesses\n * @property {string} opportunities\n * @property {string} threats\n */\n\n// --- CORE DATA STATE (EXPORTED FOR GLOBAL ACCESS) ---\n/** @type {import('vue').UnwrapRef<Territory[]>} */\nexport const territories = reactive([]);\n\n/** @type {import('vue').UnwrapRef<Node[]>} */\nexport const nodes = reactive([]);\n\n/** @type {import('vue').UnwrapRef<Edge[]>} */\nexport const edges = reactive([]);\n\n// --- FEATURE/UI STATE ---\nexport const chatInput = ref('');\nexport const isGenerating = ref(false); // Loading state for LLM calls\n\n/** @type {import('vue').UnwrapRef<SWOT>} */\nexport const swot = reactive({ strengths:'', weaknesses:'', opportunities:'', threats:'' });\n\n// ---------- AUTO-SAVE / AUTO-LOAD (Enhanced Persistence) ----------\nimport {\n    debouncedAutoSave,\n    immediateAutoSave,\n    loadSavedState,\n    exportData as exportDataFile,\n    importData as importDataFile\n} from './usePersistence.js';\n\n/**\n * Get current state snapshot\n * @returns {Object} Current state\n */\nfunction getStateSnapshot() {\n    return {\n        territories: JSON.parse(JSON.stringify(territories)),\n        nodes: JSON.parse(JSON.stringify(nodes)),\n        edges: JSON.parse(JSON.stringify(edges)),\n        timestamp: Date.now()\n    };\n}\n\n/**\n * Auto-save current canvas state (debounced for frequent edits)\n * Called after node edits, property changes\n */\nexport function autoSave() {\n    const state = getStateSnapshot();\n    debouncedAutoSave(state);\n}\n\n/**\n * Immediate save for critical operations\n * Called after delete, duplicate, drag operations\n */\nexport function immediateSave() {\n    const state = getStateSnapshot();\n    immediateAutoSave(state);\n}\n\n/**\n * Auto-load canvas state from localStorage\n * Called on page load\n * @returns {boolean} True if state was loaded successfully\n */\nexport function autoLoad() {\n    try {\n        const state = loadSavedState();\n        if (!state) {\n            console.log('‚ÑπÔ∏è No saved state found, will generate initial map');\n            return false;\n        }\n\n        // Clear current state\n        territories.splice(0);\n        nodes.splice(0);\n        edges.splice(0);\n\n        // Load saved data\n        (state.territories || []).forEach(t => territories.push(t));\n        (state.nodes || []).forEach(n => nodes.push(n));\n        (state.edges || []).forEach(e => edges.push(e));\n\n        console.log('‚úÖ State loaded from', new Date(state.timestamp).toLocaleString());\n        return true;\n    } catch (error) {\n        console.error('‚ùå Auto-load failed:', error);\n        return false;\n    }\n}\n\n/**\n * Export current state to JSON file\n */\nexport function exportState() {\n    try {\n        const state = getStateSnapshot();\n        exportDataFile(state);\n        console.log('‚úì State exported successfully');\n    } catch (error) {\n        console.error('‚ùå Export failed:', error);\n        throw error;\n    }\n}\n\n/**\n * Import state from JSON file\n * @param {File} file - File to import\n * @returns {Promise<void>}\n */\nexport async function importState(file) {\n    try {\n        const state = await importDataFile(file);\n\n        // Clear current state\n        territories.splice(0);\n        nodes.splice(0);\n        edges.splice(0);\n\n        // Load imported data\n        (state.territories || []).forEach(t => territories.push(t));\n        (state.nodes || []).forEach(n => nodes.push(n));\n        (state.edges || []).forEach(e => edges.push(e));\n\n        // Save to localStorage\n        immediateSave();\n        console.log('‚úì State imported successfully');\n    } catch (error) {\n        console.error('‚ùå Import failed:', error);\n        throw error;\n    }\n}\n\n// ---------- SNAPSHOT (localStorage simple) ----------\n/**\n * Save current state to localStorage history\n * @param {string} [name] - Optional snapshot name\n * @throws {Error} If localStorage is unavailable\n */\nexport function saveSnapshot(name) {\n    try {\n        const raw = localStorage.getItem('mvp-history');\n        const history = raw ? JSON.parse(raw) : [];\n\n        // Ensure deep copy for saving the current state\n        const data = {\n            territories: JSON.parse(JSON.stringify(territories)),\n            nodes: JSON.parse(JSON.stringify(nodes)),\n            edges: JSON.parse(JSON.stringify(edges)),\n            swot: {...swot},\n            ts: Date.now(),\n            name\n        };\n\n        history.push({\n            id: crypto.randomUUID(),\n            ts: Date.now(),\n            name: name || `snap-${history.length+1}`,\n            data\n        });\n\n        localStorage.setItem('mvp-history', JSON.stringify(history));\n    } catch (error) {\n        console.error('Failed to save snapshot:', error);\n        throw new Error(`Snapshot save failed: ${error.message}`);\n    }\n}\n\n/**\n * Load snapshot from history by index\n * @param {number} index - Snapshot index in history array\n * @throws {Error} If snapshot not found or invalid\n */\nexport function loadSnapshot(index) {\n    try {\n        const raw = localStorage.getItem('mvp-history');\n        if (!raw) {\n            throw new Error('No saved history found');\n        }\n\n        const history = JSON.parse(raw);\n        const snap = history[index];\n\n        if (!snap || !snap.data) {\n            throw new Error(`Invalid snapshot at index ${index}`);\n        }\n\n        // Clear current state and push new data (maintaining reactivity)\n        territories.splice(0);\n        nodes.splice(0);\n        edges.splice(0);\n\n        (snap.data.territories || []).forEach(t => territories.push(t));\n        (snap.data.nodes || []).forEach(n => nodes.push(n));\n        (snap.data.edges || []).forEach(e => edges.push(e));\n\n        // Restore SWOT if available\n        if (snap.data.swot) {\n            Object.assign(swot, snap.data.swot);\n        }\n    } catch (error) {\n        console.error('Failed to load snapshot:', error);\n        throw new Error(`Snapshot load failed: ${error.message}`);\n    }\n}\n\n// ---------- TERRITORY POSITIONING CONSTANTS ----------\nconst TERRITORY_PADDING = 20;      // px from edges\nconst TERRITORY_HEADER = 60;       // Space for territory title\nconst NODE_WIDTH = 180;\nconst NODE_HEIGHT = 80;\nconst NODE_SPACING_X = 20;         // Horizontal spacing between nodes\nconst NODE_SPACING_Y = 20;         // Vertical spacing between nodes\nconst COLS_PER_TERRITORY = 2;      // Number of columns in territory grid\nconst TERRITORY_SPACING = 50;      // Space between territories\nconst TERRITORY_COLS = 3;          // Number of territory columns in layout\n\n/**\n * Calculate optimal territory dimensions based on number of nodes\n * @param {number} nodeCount - Number of nodes in territory\n * @returns {{ width: number, height: number }}\n */\nfunction calculateTerritoryDimensions(nodeCount) {\n    const rows = Math.ceil(nodeCount / COLS_PER_TERRITORY);\n\n    const width =\n        TERRITORY_PADDING * 2 +\n        (COLS_PER_TERRITORY * NODE_WIDTH) +\n        ((COLS_PER_TERRITORY - 1) * NODE_SPACING_X);\n\n    const height =\n        TERRITORY_HEADER +\n        TERRITORY_PADDING * 2 +\n        (rows * NODE_HEIGHT) +\n        ((rows - 1) * NODE_SPACING_Y);\n\n    // Minimum dimensions\n    return {\n        width: Math.max(width, 400),\n        height: Math.max(height, 350)\n    };\n}\n\n/**\n * Position a node inside its territory with bounds checking\n * @param {Node} node - Node to position\n * @param {Territory} territory - Parent territory\n * @param {number} indexInTerritory - Index of node within territory\n * @returns {{ x: number, y: number }}\n */\nfunction positionNodeInTerritory(node, territory, indexInTerritory) {\n    const col = indexInTerritory % COLS_PER_TERRITORY;\n    const row = Math.floor(indexInTerritory / COLS_PER_TERRITORY);\n\n    // Calculate initial position\n    const x = territory.x + TERRITORY_PADDING + (col * (NODE_WIDTH + NODE_SPACING_X));\n    const y = territory.y + TERRITORY_HEADER + TERRITORY_PADDING + (row * (NODE_HEIGHT + NODE_SPACING_Y));\n\n    // CRITICAL: Ensure node doesn't exceed territory bounds\n    const maxX = territory.x + territory.w - NODE_WIDTH - TERRITORY_PADDING;\n    const maxY = territory.y + territory.h - NODE_HEIGHT - TERRITORY_PADDING;\n\n    const finalX = Math.min(x, maxX);\n    const finalY = Math.min(y, maxY);\n\n    // Visual debugging - check if clamping occurred\n    if (x !== finalX || y !== finalY) {\n        console.warn(`‚ö†Ô∏è Node \"${node.label}\" clamped in territory \"${territory.label}\":`, {\n            original: { x, y },\n            clamped: { x: finalX, y: finalY },\n            territory: {\n                bounds: {\n                    x: territory.x,\n                    y: territory.y,\n                    w: territory.w,\n                    h: territory.h\n                },\n                maxAllowed: { x: maxX, y: maxY }\n            }\n        });\n    }\n\n    return { x: finalX, y: finalY };\n}\n\n// ---------- NODE MANAGEMENT ----------\n/**\n * Delete a node and all its connected edges\n * @param {string} nodeId - ID of the node to delete\n * @returns {boolean} True if node was deleted successfully\n */\nexport function deleteNode(nodeId) {\n    try {\n        // Find the node\n        const nodeIndex = nodes.findIndex(n => n.id === nodeId);\n        if (nodeIndex === -1) {\n            console.warn(`Node ${nodeId} not found`);\n            return false;\n        }\n\n        const node = nodes[nodeIndex];\n        console.log(`üóëÔ∏è Deleting node \"${node.label}\" (${nodeId})`);\n\n        // Remove the node from the array\n        nodes.splice(nodeIndex, 1);\n\n        // Remove all edges connected to this node\n        const edgesToRemove = edges.filter(e => e.source === nodeId || e.target === nodeId);\n        edgesToRemove.forEach(edge => {\n            const edgeIndex = edges.findIndex(e => e.id === edge.id);\n            if (edgeIndex !== -1) {\n                edges.splice(edgeIndex, 1);\n                console.log(`  ‚Üí Removed edge ${edge.id}`);\n            }\n        });\n\n        // Remove node from its parent territory's nodeIds\n        territories.forEach(territory => {\n            if (territory.nodeIds && territory.nodeIds.includes(nodeId)) {\n                const idIndex = territory.nodeIds.indexOf(nodeId);\n                territory.nodeIds.splice(idIndex, 1);\n                console.log(`  ‚Üí Removed from territory \"${territory.label}\"`);\n            }\n        });\n\n        // Immediate save after deletion (critical operation)\n        immediateSave();\n\n        console.log(`‚úÖ Node deleted successfully (${edgesToRemove.length} edges removed)`);\n        return true;\n    } catch (error) {\n        console.error('Failed to delete node:', error);\n        return false;\n    }\n}\n\n// ---------- STUBS for analysis & map generation ----------\nexport function runAnalysis() {\n    // rule-based stub: fill swot from chatInput for demo\n    if (chatInput.value.toLowerCase().includes('ielts')) {\n      swot.strengths = 'Good listening';\n      swot.weaknesses = 'Timing in writing';\n    } else {\n      swot.strengths = 'Creative';\n    }\n    alert('SWOT drafted (stub).');\n}\n\nexport async function generateMap() {\n    if (isGenerating.value) {\n        console.warn('Map generation already in progress');\n        return;\n    }\n\n    try {\n        isGenerating.value = true;\n        console.log('üöÄ Starting map generation...');\n\n        // Clear existing data\n        territories.splice(0); nodes.splice(0); edges.splice(0);\n\n        // Call backend API to generate map using LLM (same server, relative path)\n        const response = await fetch('/api/generate', {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({\n                prompt: chatInput.value || 'Create a learning plan for IELTS preparation with listening, reading, writing, and speaking skills'\n            })\n        });\n\n        if (!response.ok) {\n            const errorData = await response.json().catch(() => null);\n            const errorMessage = errorData?.error || `Server error: ${response.status}`;\n            throw new Error(errorMessage);\n        }\n\n        const data = await response.json();\n\n        // Check if LLM succeeded\n        if (!data.success) {\n            throw new Error(data.error || 'Map generation failed');\n        }\n\n        // Warn if fallback was used\n        if (data.metadata?.fallback) {\n            console.warn('‚ö†Ô∏è Using fallback map - LLM response was invalid');\n            alert('Warning: Map generation used fallback mode. Results may be limited.');\n        }\n\n        const mapData = data.data; // Backend returns { success: true, data: mapJson }\n\n        // LLM returns nodes WITH x,y coordinates - override them with our positioning algorithm\n        const llmNodes = mapData.nodes.map(n => ({\n            id: n.id || crypto.randomUUID(),\n            label: n.label,\n            type: n.type || 'concept',\n            note: '',\n            status: 'todo',\n            timestamp: Date.now()\n        }));\n\n        const llmEdges = mapData.edges.map(e => ({\n            id: e.id || crypto.randomUUID(),\n            source: e.source,\n            target: e.target,\n            type: e.type || 'relationship'\n        }));\n\n        // Add to state\n        llmNodes.forEach(n => nodes.push(n));\n        llmEdges.forEach(e => edges.push(e));\n\n        // Handle territories from LLM FIRST (before positioning nodes)\n        if (mapData.territories && mapData.territories.length > 0) {\n            console.log('üó∫Ô∏è Creating territories with dynamic sizing...');\n\n            mapData.territories.forEach((t, index) => {\n                const nodeCount = (t.nodeIds || []).length;\n\n                // Calculate dimensions based on node count\n                const dimensions = calculateTerritoryDimensions(nodeCount);\n\n                // Position territories in a grid layout\n                const col = index % TERRITORY_COLS;\n                const row = Math.floor(index / TERRITORY_COLS);\n\n                const territory = {\n                    id: t.id || crypto.randomUUID(),\n                    label: t.name,\n                    x: 100 + col * (dimensions.width + TERRITORY_SPACING),\n                    y: 100 + row * (dimensions.height + TERRITORY_SPACING),\n                    w: dimensions.width,\n                    h: dimensions.height,\n                    nodeIds: t.nodeIds || []\n                };\n\n                territories.push(territory);\n\n                // Debug log\n                console.log(`  üì¶ Territory \"${territory.label}\":`, {\n                    nodes: nodeCount,\n                    dimensions: { w: dimensions.width, h: dimensions.height },\n                    position: { x: territory.x, y: territory.y }\n                });\n            });\n        }\n\n        // Position nodes INSIDE their territories\n        console.log('\\nüìç Positioning nodes within territories...');\n        let nodesPositioned = 0;\n        let nodesOutside = 0;\n\n        nodes.forEach(node => {\n            // Find which territory this node belongs to\n            const territory = territories.find(t =>\n                t.nodeIds && t.nodeIds.includes(node.id)\n            );\n\n            if (territory) {\n                // Find index within territory\n                const indexInTerritory = territory.nodeIds.indexOf(node.id);\n\n                // Use helper function with bounds checking\n                const position = positionNodeInTerritory(node, territory, indexInTerritory);\n                node.x = position.x;\n                node.y = position.y;\n\n                nodesPositioned++;\n\n                // Debug: verify node is within bounds\n                const isWithinBounds =\n                    node.x >= territory.x &&\n                    node.x + NODE_WIDTH <= territory.x + territory.w &&\n                    node.y >= territory.y &&\n                    node.y + NODE_HEIGHT <= territory.y + territory.h;\n\n                if (!isWithinBounds) {\n                    console.error(`‚ùå Node \"${node.label}\" STILL outside territory \"${territory.label}\"!`, {\n                        node: { x: node.x, y: node.y },\n                        territory: { x: territory.x, y: territory.y, w: territory.w, h: territory.h }\n                    });\n                }\n            } else {\n                // Fallback: random position if no territory\n                node.x = Math.random() * 800 + 100;\n                node.y = Math.random() * 600 + 100;\n                nodesOutside++;\n                console.warn(`‚ö†Ô∏è Node \"${node.label}\" has no territory assignment`);\n            }\n        });\n\n        console.log(`‚úì Positioned ${nodesPositioned} nodes, ${nodesOutside} outside territories`);\n\n        saveSnapshot('auto-generate');\n        immediateSave(); // Immediate save after successful generation\n        console.log('‚úÖ Map generation complete!');\n        console.log(`   ‚Üí ${territories.length} territories`);\n        console.log(`   ‚Üí ${nodes.length} nodes`);\n        console.log(`   ‚Üí ${edges.length} edges`);\n    } catch (error) {\n        console.error('‚ùå Map generation failed:', error);\n\n        // Show user-friendly error message\n        let userMessage = 'Failed to generate map. ';\n\n        if (error.message.includes('Rate limit') || error.message.includes('busy')) {\n            userMessage += 'The AI service is currently busy. Please wait a moment and try again.';\n        } else if (error.message.includes('API key') || error.message.includes('not configured')) {\n            userMessage += 'API configuration error. Please check your API keys.';\n        } else if (error.message.includes('Invalid map structure')) {\n            userMessage += 'The AI returned an invalid response. Please try a different prompt.';\n        } else {\n            userMessage += error.message;\n        }\n\n        alert(userMessage);\n\n        // Re-throw to prevent partial state\n        throw error;\n    } finally {\n        isGenerating.value = false;\n    }\n}\n\nexport function useState() {\n    return {\n        // Data arrays\n        territories, nodes, edges,\n        // Feature state\n        chatInput, swot, isGenerating,\n        // Functions\n        saveSnapshot, loadSnapshot, runAnalysis, generateMap,\n        autoSave, immediateSave, autoLoad, deleteNode,\n        exportState, importState\n    }\n}","// src/composables/useCanvas.js\nimport { reactive, ref, onMounted, onUnmounted } from 'vue';\n\n/**\n * @typedef {Object} ViewBox\n * @property {number} x - X offset\n * @property {number} y - Y offset\n * @property {number} w - Width\n * @property {number} h - Height\n */\n\n/**\n * @typedef {Object} Point\n * @property {number} x - X coordinate\n * @property {number} y - Y coordinate\n */\n\nconst initView = reactive({ x: 0, y: 0, w: 1600, h: 900 });\n\n/** @type {import('vue').UnwrapRef<ViewBox>} */\nexport const viewBox = reactive({ x: initView.x, y: initView.y, w: initView.w, h: initView.h });\n\nconst isPanning = ref(false);\nconst lastPan = reactive({ x: 0, y: 0 });\n\n// ---------- UTIL: coord conversion (EXPORTED) ----------\n/**\n * Convert screen mouse event to world coordinates\n * @param {MouseEvent} e - Mouse event\n * @returns {Point} World coordinates\n */\nexport function svgToWorld(e) {\n  const svg = document.querySelector('svg');\n  if (!svg) {\n    console.warn('SVG element not found');\n    return { x: 0, y: 0 };\n  }\n\n  const r = svg.getBoundingClientRect();\n  const px = (e.clientX - r.left) / r.width;\n  const py = (e.clientY - r.top) / r.height;\n\n  return {\n    x: viewBox.x + px * viewBox.w,\n    y: viewBox.y + py * viewBox.h\n  };\n}\n\n/**\n * Convert world node coordinates to screen position\n * @param {Object} node - Node with x, y properties\n * @param {number} node.x - World X coordinate\n * @param {number} node.y - World Y coordinate\n * @returns {Point & {rect: DOMRect}} Screen coordinates with SVG rect\n */\nexport function worldToScreen(node) {\n  const svg = document.querySelector('svg');\n  if (!svg) {\n    console.warn('SVG element not found');\n    return { x: 0, y: 0, rect: null };\n  }\n\n  const r = svg.getBoundingClientRect();\n  const sx = ((node.x - viewBox.x) / viewBox.w) * r.width + r.left;\n  const sy = ((node.y - viewBox.y) / viewBox.h) * r.height + r.top;\n\n  return { x: sx, y: sy, rect: r };\n}\n\n// ---------- PAN (canvas dragging) ----------\nexport function onPanStart(e) {\n  isPanning.value = true;\n  lastPan.x = e.clientX;\n  lastPan.y = e.clientY;\n}\nexport function onPanMove(e) {\n  if (!isPanning.value) return;\n  const svg = e.currentTarget; \n  const dx = (e.clientX - lastPan.x) * (viewBox.w / svg.clientWidth);\n  const dy = (e.clientY - lastPan.y) * (viewBox.h / svg.clientHeight);\n  viewBox.x -= dx;\n  viewBox.y -= dy;\n  lastPan.x = e.clientX;\n  lastPan.y = e.clientY;\n}\nexport function onPanEnd() { isPanning.value = false; }\n\n// ---------- WHEEL (zoom at cursor) ----------\nexport const onWheel = (event) => {\n  const svg = event.currentTarget;\n  const rect = svg.getBoundingClientRect();\n  const mouseX = event.clientX - rect.left;\n  const mouseY = event.clientY - rect.top;\n  const scaleFactor = event.deltaY < 0 ? 0.9 : 1.1; // zoom in when scroll up\n  const worldMx = viewBox.x + (mouseX / rect.width) * viewBox.w;\n  const worldMy = viewBox.y + (mouseY / rect.height) * viewBox.h;\n\n  // new size\n  const newW = viewBox.w * scaleFactor;\n  const newH = viewBox.h * scaleFactor;\n  // keep the zoom centered on mouse\n  viewBox.x = worldMx - (mouseX / rect.width) * newW;\n  viewBox.y = worldMy - (mouseY / rect.height) * newH;\n  viewBox.w = newW;\n  viewBox.h = newH;\n};\n\n// ---------- ZOOM TO NODE (smooth-ish) ----------\nexport function zoomToNode(node, scale = 2, duration = 300) {\n  const start = { x: viewBox.x, y: viewBox.y, w: viewBox.w, h: viewBox.h };\n  const cx = node.x, cy = node.y;\n  const targetW = initView.w / scale;\n  const targetH = initView.h / scale;\n  const target = { x: cx - targetW / 2, y: cy - targetH / 2, w: targetW, h: targetH };\n  const t0 = performance.now();\n  function step(t) {\n    const p = Math.min(1, (t - t0) / duration);\n    const e = 1 - Math.pow(1 - p, 2); // easeOutQuad\n    viewBox.x = start.x + (target.x - start.x) * e;\n    viewBox.y = start.y + (target.y - start.y) * e;\n    viewBox.w = start.w + (target.w - start.w) * e;\n    viewBox.h = start.h + (target.h - start.h) * e;\n    if (p < 1) requestAnimationFrame(step);\n  }\n  requestAnimationFrame(step);\n}\n\n\nexport function useCanvas() {\n    return {\n        viewBox, isPanning,\n        onPanStart, onPanMove, onPanEnd, onWheel,\n        svgToWorld, worldToScreen, zoomToNode,\n    }\n}","// src/composables/useNodes.js\nimport { reactive, ref } from 'vue';\nimport { nodes, territories, immediateSave } from './useState.js';\nimport { svgToWorld, viewBox } from './useCanvas.js';\n\n// Territory boundary constraints\nconst NODE_WIDTH = 180;\nconst NODE_HEIGHT = 80;\nconst TERRITORY_PADDING = 20;\n\n/**\n * @typedef {Object} DragState\n * @property {boolean} active - Is dragging active\n * @property {string|null} id - Node being dragged\n * @property {number} ox - Offset X\n * @property {number} oy - Offset Y\n */\n\n// --- NODE/SELECTION STATE ---\nconst selectedNode = ref(null);\nconst quickNodeLabel = ref('');\nconst editingNode = ref(null);\n\n/** @type {import('vue').UnwrapRef<DragState>} */\nconst dragging = reactive({ active: false, id: null, ox: 0, oy: 0 });\n\n// ---------- NODE / EDGE CRUD helpers ----------\n/**\n * Find node by ID\n * @param {string} id - Node ID\n * @returns {import('./useState').Node|undefined}\n */\nexport function nodeById(id) {\n  return nodes.find(n => n.id === id);\n}\n\n/**\n * Select a node for editing\n * @param {import('./useState').Node} n - Node to select\n */\nexport function selectNode(n) {\n  selectedNode.value = n;\n  editingNode.value = n;\n}\n\n/**\n * Deselect current node\n */\nexport function deselectNode() {\n  selectedNode.value = null;\n  editingNode.value = null;\n}\n\n/**\n * Quick add a new node at viewport center\n */\nexport function quickAddNode() {\n  const label = quickNodeLabel.value.trim();\n  if (!label) {\n    console.warn('Cannot add node with empty label');\n    return;\n  }\n\n  const id = crypto.randomUUID();\n  const newNode = {\n    id,\n    label,\n    x: viewBox.x + viewBox.w / 2,\n    y: viewBox.y + viewBox.h / 2,\n    territoryId: null,\n    note: '',\n    status: 'todo',\n    timestamp: Date.now()\n  };\n\n  nodes.push(newNode);\n  quickNodeLabel.value = '';\n}\n\n// ---------- NODE DRAGGING (Uses svgToWorld from useCanvas) ----------\nexport const onNodeDragStart = (e, node) => {\n  e.stopPropagation(); \n  const p = svgToWorld(e); // <-- CRITICAL: Uses imported helper\n  dragging.active = true;\n  dragging.id = node.id;\n  dragging.ox = p.x - node.x;\n  dragging.oy = p.y - node.y;\n  window.addEventListener('mousemove', onNodeDragMove);\n  window.addEventListener('mouseup', onNodeDragEnd);\n};\n\nexport const onNodeDragMove = (e) => {\n  if (!dragging.active || !dragging.id) return;\n  const p = svgToWorld(e);\n  const n = nodes.find(x => x.id === dragging.id);\n  if (!n) return;\n\n  // Calculate new position\n  let newX = p.x - dragging.ox;\n  let newY = p.y - dragging.oy;\n\n  // Find which territory this node belongs to\n  const territory = territories.find(t =>\n    t.nodeIds && t.nodeIds.includes(n.id)\n  );\n\n  // Constrain to territory bounds if node is in a territory\n  if (territory) {\n    // Min bounds (left, top)\n    const minX = territory.x + TERRITORY_PADDING;\n    const minY = territory.y + 60 + TERRITORY_PADDING; // 60 = header height\n\n    // Max bounds (right, bottom) - account for node size\n    const maxX = territory.x + territory.w - NODE_WIDTH / 2 - TERRITORY_PADDING;\n    const maxY = territory.y + territory.h - NODE_HEIGHT / 2 - TERRITORY_PADDING;\n\n    // Clamp position\n    newX = Math.max(minX + NODE_WIDTH / 2, Math.min(newX, maxX));\n    newY = Math.max(minY + NODE_HEIGHT / 2, Math.min(newY, maxY));\n\n    // Visual feedback when hitting boundary\n    const isAtBoundary =\n      newX !== (p.x - dragging.ox) || newY !== (p.y - dragging.oy);\n\n    if (isAtBoundary && !n._boundaryWarned) {\n      console.log(`üöß Node \"${n.label}\" constrained to territory \"${territory.label}\"`);\n      n._boundaryWarned = true; // Prevent log spam\n    }\n  }\n\n  n.x = newX;\n  n.y = newY;\n};\n\nexport const onNodeDragEnd = (e) => {\n  // Clear boundary warning flag\n  if (dragging.id) {\n    const n = nodes.find(x => x.id === dragging.id);\n    if (n) delete n._boundaryWarned;\n  }\n\n  dragging.active = false;\n  dragging.id = null;\n  window.removeEventListener('mousemove', onNodeDragMove);\n  window.removeEventListener('mouseup', onNodeDragEnd);\n\n  // Immediate save after drag (position change)\n  immediateSave();\n};\n\nexport function useNodes() {\n    return {\n        selectedNode, quickNodeLabel, editingNode, dragging,\n        nodeById, selectNode, deselectNode, quickAddNode,\n        onNodeDragStart, onNodeDragMove, onNodeDragEnd,\n    }\n}\n\n","<template>\n  <div class=\"app\">\n    <!-- Sidebar: chat & analysis -->\n    <aside class=\"sidebar\">\n      <!-- Chat Section (Always visible) -->\n      <section class=\"sidebar-section chat-section\">\n        <h2 class=\"section-title\">Character Chat ‚ñ∏ Needs</h2>\n        <textarea\n          v-model=\"chatInput\"\n          :disabled=\"isGenerating\"\n          placeholder=\"e.g. I want to prepare for IELTS in 8 weeks; I struggle with timing and writing Task 1...\"\n          class=\"chat-textarea\"\n        ></textarea>\n        <div class=\"button-row\">\n          <button class=\"btn btn-action\" @click=\"runAnalysis\" :disabled=\"isGenerating\">\n            Analyze SWOT\n          </button>\n          <button class=\"btn btn-action\" @click=\"generateMap\" :disabled=\"isGenerating\">\n            <span v-if=\"!isGenerating\">Generate Map</span>\n            <span v-else class=\"spinner-row\">\n              <span class=\"spinner\"></span>\n              Generating...\n            </span>\n          </button>\n        </div>\n      </section>\n\n      <!-- SWOT Section (Collapsible) -->\n      <section class=\"sidebar-section swot-section\">\n        <button class=\"section-toggle\" @click=\"swotExpanded = !swotExpanded\">\n          <span class=\"toggle-icon\">{{ swotExpanded ? '‚ñº' : '‚ñ∂' }}</span>\n          <h2 class=\"section-title-inline\">SWOT Analysis</h2>\n        </button>\n\n        <div v-if=\"swotExpanded\" class=\"swot-grid\">\n          <div class=\"swot-quadrant\">\n            <label class=\"swot-label\">Strengths</label>\n            <textarea v-model=\"swot.strengths\" rows=\"3\"></textarea>\n          </div>\n          <div class=\"swot-quadrant\">\n            <label class=\"swot-label\">Weaknesses</label>\n            <textarea v-model=\"swot.weaknesses\" rows=\"3\"></textarea>\n          </div>\n          <div class=\"swot-quadrant\">\n            <label class=\"swot-label\">Opportunities</label>\n            <textarea v-model=\"swot.opportunities\" rows=\"3\"></textarea>\n          </div>\n          <div class=\"swot-quadrant\">\n            <label class=\"swot-label\">Threats</label>\n            <textarea v-model=\"swot.threats\" rows=\"3\"></textarea>\n          </div>\n        </div>\n      </section>\n\n      <!-- File Management (Compact icon bar) -->\n      <section class=\"sidebar-section file-section\">\n        <div class=\"file-actions\">\n          <button class=\"icon-btn\" @click=\"handleSave\" title=\"Save current state\">\n            üíæ\n          </button>\n          <button class=\"icon-btn\" @click=\"handleLoad\" title=\"Load saved state\">\n            üìÇ\n          </button>\n          <button class=\"icon-btn\" @click=\"handleExport\" title=\"Export as JSON\">\n            üì•\n          </button>\n          <button class=\"icon-btn\" @click=\"handleImport\" title=\"Import from JSON\">\n            üì§\n          </button>\n          <button class=\"icon-btn icon-btn-danger\" @click=\"handleReset\" title=\"Reset all data\">\n            üóëÔ∏è\n          </button>\n        </div>\n      </section>\n    </aside>\n\n    <!-- Main: toolbar + canvas -->\n    <main class=\"main\">\n      <div class=\"toolbar\">\n        <!-- Group 1: View Controls -->\n        <div class=\"toolbar-group\">\n          <span class=\"badge\" title=\"Current zoom level\">Zoom: {{ zoomPercentage }}%</span>\n          <button class=\"btn toolbar-btn\" @click=\"() => zoomAtCenter(1.2)\" title=\"Zoom in\">+</button>\n          <button class=\"btn toolbar-btn\" @click=\"() => zoomAtCenter(1 / 1.2)\" title=\"Zoom out\">‚àí</button>\n          <button class=\"btn toolbar-btn\" @click=\"centerView\" title=\"Reset view to center\">Center</button>\n        </div>\n\n        <!-- Divider -->\n        <div class=\"toolbar-divider\"></div>\n\n        <!-- Group 2: Quick Add (CTA Style) -->\n        <div class=\"toolbar-group toolbar-group-cta\">\n          <input\n            type=\"text\"\n            placeholder=\"Quick add node...\"\n            v-model=\"quickNodeLabel\"\n            @keydown.enter=\"quickAddNode\"\n            class=\"quick-add-input\"\n            title=\"Type a label and press Enter or click Add Node\"\n          />\n          <button class=\"btn btn-primary\" @click=\"quickAddNode\" title=\"Add new node to canvas\">\n            + Add Node\n          </button>\n        </div>\n      </div>\n\n      <section class=\"canvas-wrap\">\n        <svg\n          :class=\"{ dragging: isPanning }\"\n          :viewBox=\"`${viewBox.x} ${viewBox.y} ${viewBox.w} ${viewBox.h}`\"\n          @mousedown=\"onPanStart\"\n          @mousemove=\"onPanMove\"\n          @mouseup=\"onPanEnd\"\n          @mouseleave=\"onPanEnd\"\n          @wheel.prevent=\"onWheel\"\n        >\n          <!-- defs -->\n          <defs>\n            <marker\n              id=\"arrow\"\n              viewBox=\"0 0 10 10\"\n              refX=\"10\"\n              refY=\"5\"\n              markerWidth=\"6\"\n              markerHeight=\"6\"\n              orient=\"auto-start-reverse\"\n            >\n              <path d=\"M 0 0 L 10 5 L 0 10 z\" fill=\"#b9bfd2\"></path>\n            </marker>\n          </defs>\n\n          <!-- territories -->\n          <g v-for=\"t in territories\" :key=\"t.id\">\n            <rect\n              class=\"territory\"\n              :x=\"t.x\"\n              :y=\"t.y\"\n              :rx=\"12\"\n              :ry=\"12\"\n              :width=\"t.w\"\n              :height=\"t.h\"\n            ></rect>\n            <text class=\"territory-title\" :x=\"t.x + 10\" :y=\"t.y + 18\">\n              {{ t.label }}\n            </text>\n          </g>\n\n          <!-- edges -->\n          <g>\n            <line\n              v-for=\"e in edges\"\n              :key=\"e.id\"\n              class=\"edge\"\n              :x1=\"nodeById(e.source)?.x || 0\"\n              :y1=\"nodeById(e.source)?.y || 0\"\n              :x2=\"nodeById(e.target)?.x || 0\"\n              :y2=\"nodeById(e.target)?.y || 0\"\n            />\n          </g>\n\n          <!-- nodes -->\n          <g\n            v-for=\"n in nodes\"\n            :key=\"n.id\"\n            @mousedown.stop=\"(e) => onNodeDragStart(e, n)\"\n            @dblclick.stop=\"() => selectNode(n)\"\n            @contextmenu.prevent=\"(e) => onNodeRightClick(e, n)\"\n          >\n            <rect\n              :class=\"['node', selectedNode && selectedNode.id === n.id ? 'selected' : '']\"\n              :x=\"n.x - 60\"\n              :y=\"n.y - 22\"\n              rx=\"10\"\n              ry=\"10\"\n              width=\"120\"\n              height=\"44\"\n            />\n            <text\n              class=\"node-label\"\n              :x=\"n.x\"\n              :y=\"n.y + 4\"\n              text-anchor=\"middle\"\n            >\n              {{ n.label }}\n            </text>\n          </g>\n        </svg>\n\n        <!-- Inspector Panel (when node selected) -->\n        <div v-if=\"selectedNode\" class=\"inspector\">\n          <!-- Header -->\n          <div class=\"inspector-header\">\n            <h3>{{ selectedNode.label }}</h3>\n            <button class=\"btn-icon\" @click=\"deselectNode\">‚úï</button>\n          </div>\n\n          <!-- Node Label -->\n          <div class=\"field-group\">\n            <label class=\"field-label\">Label</label>\n            <input\n              v-model=\"selectedNode.label\"\n              placeholder=\"Node name...\"\n              @input=\"handleNodeUpdate\"\n            />\n          </div>\n\n          <!-- Status -->\n          <div class=\"field-group\">\n            <label class=\"field-label\">Status</label>\n            <select v-model=\"selectedNode.status\" @change=\"handleNodeUpdate\">\n              <option value=\"todo\">To Do</option>\n              <option value=\"in-progress\">In Progress</option>\n              <option value=\"done\">Done</option>\n            </select>\n          </div>\n\n          <!-- Field Notes (Optional) -->\n          <div class=\"field-group field-notes\">\n            <label class=\"field-label\">Notes</label>\n            <textarea\n              v-model=\"selectedNode.note\"\n              placeholder=\"Add observations, insights, or leave empty...\"\n              @input=\"handleNodeUpdate\"\n            ></textarea>\n          </div>\n\n          <!-- Footer -->\n          <div class=\"inspector-footer\">\n            <span class=\"timestamp\">{{ formatTimestamp(selectedNode.timestamp) }}</span>\n          </div>\n        </div>\n      </section>\n    </main>\n\n    <!-- Custom Context Menu -->\n    <div\n      v-if=\"contextMenu.visible\"\n      class=\"context-menu\"\n      :style=\"{\n        left: contextMenu.x + 'px',\n        top: contextMenu.y + 'px'\n      }\"\n    >\n      <button class=\"context-menu-item danger\" @click=\"handleDeleteNode\">\n        <span class=\"icon\">üóëÔ∏è</span>\n        Delete \"{{ contextMenu.node?.label }}\"\n      </button>\n      <button class=\"context-menu-item\" @click=\"closeContextMenu\">\n        Cancel\n      </button>\n    </div>\n\n    <!-- Error Display -->\n    <div v-if=\"error\" class=\"error-banner\" @click=\"clearError\">\n      {{ error }} (click to dismiss)\n    </div>\n  </div>\n</template>\n\n<script>\nimport { ref, computed, onMounted, onErrorCaptured } from 'vue';\nimport { useState } from './composables/useState.js';\nimport { useCanvas } from './composables/useCanvas.js';\nimport { useNodes } from './composables/useNodes.js';\n\nexport default {\n  name: 'App',\n  setup() {\n    // UI state\n    const swotExpanded = ref(false);\n\n    // Error handling\n    const error = ref(null);\n\n    const handleError = (err, context = '') => {\n      console.error(`[App Error] ${context}:`, err);\n      error.value = `${context}: ${err.message || err}`;\n      setTimeout(() => { error.value = null; }, 5000);\n    };\n\n    const clearError = () => { error.value = null; };\n\n    // Context menu state\n    const contextMenu = ref({\n      visible: false,\n      x: 0,\n      y: 0,\n      node: null\n    });\n\n    // Capture component errors\n    onErrorCaptured((err, instance, info) => {\n      handleError(err, `Component error (${info})`);\n      return false; // Prevent error propagation\n    });\n\n    // Execute composables with error handling\n    let stateComposable, canvasComposable, nodesComposable;\n\n    try {\n      stateComposable = useState();\n      canvasComposable = useCanvas();\n      nodesComposable = useNodes();\n    } catch (err) {\n      handleError(err, 'Composable initialization failed');\n      // Provide fallbacks\n      stateComposable = { territories: ref([]), nodes: ref([]), edges: ref([]), chatInput: ref(''), swot: ref({}) };\n      canvasComposable = { viewBox: ref({ x: 0, y: 0, w: 1600, h: 900 }), isPanning: ref(false) };\n      nodesComposable = { selectedNode: ref(null), quickNodeLabel: ref('') };\n    }\n\n    // Destructure composables\n    const {\n      territories, nodes, edges, chatInput, swot, isGenerating,\n      runAnalysis, generateMap, saveSnapshot, loadSnapshot, autoLoad, deleteNode,\n      autoSave, exportState, importState\n    } = stateComposable;\n\n    const {\n      viewBox, isPanning,\n      onPanStart, onPanMove, onPanEnd, onWheel,\n      svgToWorld, worldToScreen, zoomToNode\n    } = canvasComposable;\n\n    const {\n      selectedNode, quickNodeLabel, editingNode, dragging,\n      nodeById, selectNode, deselectNode, quickAddNode,\n      onNodeDragStart, onNodeDragMove, onNodeDragEnd\n    } = nodesComposable;\n\n    // Computed zoom percentage\n    const zoomPercentage = computed(() => {\n      const initW = 1600; // Default initial width\n      return (100 * (initW / viewBox.w)).toFixed(0);\n    });\n\n    // Enhanced action handlers with error handling\n    const handleSave = () => {\n      try {\n        saveSnapshot(`manual-${Date.now()}`);\n        console.log('‚úì State saved successfully');\n      } catch (err) {\n        handleError(err, 'Save failed');\n      }\n    };\n\n    const handleLoad = () => {\n      try {\n        const index = 0; // Load latest snapshot\n        loadSnapshot(index);\n        console.log('‚úì State loaded successfully');\n      } catch (err) {\n        handleError(err, 'Load failed');\n      }\n    };\n\n    const handleReset = () => {\n      try {\n        if (confirm('Reset all data? This cannot be undone.')) {\n          territories.splice(0);\n          nodes.splice(0);\n          edges.splice(0);\n          chatInput.value = '';\n          swot.strengths = '';\n          swot.weaknesses = '';\n          swot.opportunities = '';\n          swot.threats = '';\n          console.log('‚úì Reset complete');\n        }\n      } catch (err) {\n        handleError(err, 'Reset failed');\n      }\n    };\n\n    const handleExport = () => {\n      try {\n        exportState();\n        console.log('‚úì Export successful');\n      } catch (err) {\n        handleError(err, 'Export failed');\n      }\n    };\n\n    const handleImport = () => {\n      try {\n        const input = document.createElement('input');\n        input.type = 'file';\n        input.accept = 'application/json';\n        input.onchange = async (e) => {\n          const file = e.target.files[0];\n          if (!file) return;\n\n          try {\n            await importState(file);\n            console.log('‚úì Import successful');\n          } catch (err) {\n            handleError(err, 'Import failed');\n          }\n        };\n        input.click();\n      } catch (err) {\n        handleError(err, 'Import failed');\n      }\n    };\n\n    const handleNodeUpdate = () => {\n      // Debounced auto-save (waits 500ms after last edit)\n      if (selectedNode.value) {\n        console.log('üìù Node edit detected:', selectedNode.value.label);\n        autoSave();\n      }\n    };\n\n    // Handle right-click on node - show context menu\n    const onNodeRightClick = (event, node) => {\n      try {\n        event.preventDefault();\n        event.stopPropagation();\n\n        // Position context menu at cursor\n        contextMenu.value = {\n          visible: true,\n          x: event.clientX,\n          y: event.clientY,\n          node: node\n        };\n      } catch (err) {\n        handleError(err, 'Context menu failed');\n      }\n    };\n\n    // Close context menu\n    const closeContextMenu = () => {\n      contextMenu.value.visible = false;\n      contextMenu.value.node = null;\n    };\n\n    // Handle delete from context menu\n    const handleDeleteNode = () => {\n      try {\n        const node = contextMenu.value.node;\n        if (!node) return;\n\n        // Close inspector if this node is selected\n        if (selectedNode.value && selectedNode.value.id === node.id) {\n          deselectNode();\n        }\n\n        // Delete the node\n        const success = deleteNode(node.id);\n\n        if (!success) {\n          handleError(new Error('Failed to delete node'), 'Delete failed');\n        }\n\n        // Close context menu\n        closeContextMenu();\n      } catch (err) {\n        handleError(err, 'Delete node failed');\n      }\n    };\n\n    // Format timestamp for display\n    const formatTimestamp = (ts) => {\n      if (!ts) return '';\n      const date = new Date(ts);\n      const now = new Date();\n      const diffMs = now - date;\n      const diffMins = Math.floor(diffMs / 60000);\n\n      if (diffMins < 1) return 'Just now';\n      if (diffMins < 60) return `${diffMins}m ago`;\n      if (diffMins < 1440) return `${Math.floor(diffMins / 60)}h ago`;\n      return date.toLocaleDateString();\n    };\n\n    // Zoom controls\n    const zoomAtCenter = (factor) => {\n      try {\n        const cx = viewBox.x + viewBox.w / 2;\n        const cy = viewBox.y + viewBox.h / 2;\n        const newW = viewBox.w / factor;\n        const newH = viewBox.h / factor;\n        viewBox.x = cx - newW / 2;\n        viewBox.y = cy - newH / 2;\n        viewBox.w = newW;\n        viewBox.h = newH;\n      } catch (err) {\n        handleError(err, 'Zoom failed');\n      }\n    };\n\n    const centerView = () => {\n      try {\n        viewBox.x = 0;\n        viewBox.y = 0;\n        viewBox.w = 1600;\n        viewBox.h = 900;\n      } catch (err) {\n        handleError(err, 'Center view failed');\n      }\n    };\n\n    // Mount lifecycle\n    onMounted(() => {\n      try {\n        // Try to load saved state first\n        const loaded = autoLoad && typeof autoLoad === 'function' && autoLoad();\n\n        // If no saved state, generate initial demo map\n        if (!loaded && generateMap && typeof generateMap === 'function') {\n          console.log('No saved state, generating initial map...');\n          generateMap();\n        }\n\n        // Global click handler to close context menu\n        const handleGlobalClick = (e) => {\n          // Check if click is outside context menu\n          if (contextMenu.value.visible && !e.target.closest('.context-menu')) {\n            closeContextMenu();\n          }\n        };\n\n        document.addEventListener('click', handleGlobalClick);\n\n        // Cleanup on unmount\n        return () => {\n          document.removeEventListener('click', handleGlobalClick);\n        };\n      } catch (err) {\n        handleError(err, 'Initialization failed');\n      }\n    });\n\n    // Return everything to template\n    return {\n      // UI state\n      swotExpanded,\n\n      // State\n      chatInput,\n      swot,\n      isGenerating,\n      territories,\n      nodes,\n      edges,\n      selectedNode,\n      quickNodeLabel,\n      editingNode,\n      contextMenu,\n\n      // View\n      viewBox,\n      isPanning,\n      zoomPercentage,\n\n      // Actions\n      runAnalysis,\n      generateMap,\n      handleSave,\n      handleLoad,\n      handleReset,\n      handleExport,\n      handleImport,\n      handleNodeUpdate,\n      onNodeRightClick,\n      closeContextMenu,\n      handleDeleteNode,\n      onWheel,\n      onPanStart,\n      onPanMove,\n      onPanEnd,\n      onNodeDragStart,\n      onNodeDragMove,\n      onNodeDragEnd,\n      nodeById,\n      selectNode,\n      deselectNode,\n      quickAddNode,\n      zoomToNode,\n      zoomAtCenter,\n      centerView,\n      formatTimestamp,\n\n      // Error handling\n      error,\n      clearError\n    };\n  }\n};\n</script>\n\n<style scoped>\n.app {\n  display: grid;\n  grid-template-columns: 280px 1fr;\n  height: 100vh;\n}\n\n/* ===== SIDEBAR ===== */\n.sidebar {\n  border-right: 1px solid #e5e7eb;\n  background: #fafbfc;\n  display: flex;\n  flex-direction: column;\n  overflow-y: auto;\n}\n\n.sidebar-section {\n  padding: 16px;\n  border-bottom: 1px solid #e5e7eb;\n}\n\n/* Chat Section */\n.chat-section {\n  padding: 18px;\n  background: #fff;\n}\n\n.section-title {\n  margin: 0 0 12px;\n  font-size: 15px;\n  font-weight: 600;\n  color: #1f2937;\n}\n\n.chat-textarea {\n  width: 100%;\n  min-height: 100px;\n  padding: 12px;\n  border: 1px solid #d1d5db;\n  border-radius: 8px;\n  resize: vertical;\n  font-family: inherit;\n  font-size: 14px;\n  line-height: 1.5;\n  transition: border-color 0.2s, box-shadow 0.2s;\n}\n\n.chat-textarea:focus {\n  outline: none;\n  border-color: #3b82f6;\n  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);\n}\n\n.button-row {\n  display: flex;\n  gap: 8px;\n  margin-top: 10px;\n}\n\n.btn-action {\n  flex: 1;\n  padding: 10px 14px;\n  border: none;\n  border-radius: 8px;\n  background: #111827;\n  color: #fff;\n  font-size: 13px;\n  font-weight: 500;\n  cursor: pointer;\n  transition: background 0.2s, transform 0.1s;\n}\n\n.btn-action:hover:not(:disabled) {\n  background: #1f2937;\n  transform: translateY(-1px);\n}\n\n.btn-action:active:not(:disabled) {\n  transform: translateY(0);\n}\n\n.btn-action:disabled {\n  opacity: 0.6;\n  cursor: not-allowed;\n}\n\n.spinner-row {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.spinner {\n  width: 14px;\n  height: 14px;\n  border: 2px solid rgba(255, 255, 255, 0.3);\n  border-top-color: #fff;\n  border-radius: 50%;\n  animation: spin 0.8s linear infinite;\n}\n\n@keyframes spin {\n  to { transform: rotate(360deg); }\n}\n\n/* SWOT Section */\n.swot-section {\n  background: #fff;\n}\n\n.section-toggle {\n  width: 100%;\n  padding: 12px 0;\n  border: none;\n  background: transparent;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  cursor: pointer;\n  transition: opacity 0.2s;\n}\n\n.section-toggle:hover {\n  opacity: 0.7;\n}\n\n.toggle-icon {\n  font-size: 12px;\n  color: #6b7280;\n  transition: transform 0.2s;\n}\n\n.section-title-inline {\n  margin: 0;\n  font-size: 15px;\n  font-weight: 600;\n  color: #1f2937;\n}\n\n.swot-grid {\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  gap: 10px;\n  margin-top: 12px;\n}\n\n.swot-quadrant {\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n}\n\n.swot-label {\n  font-size: 11px;\n  font-weight: 600;\n  color: #6b7280;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n}\n\n.swot-quadrant textarea {\n  width: 100%;\n  padding: 8px;\n  border: 1px solid #d1d5db;\n  border-radius: 6px;\n  resize: vertical;\n  font-family: inherit;\n  font-size: 13px;\n  line-height: 1.4;\n  transition: border-color 0.2s;\n}\n\n.swot-quadrant textarea:focus {\n  outline: none;\n  border-color: #3b82f6;\n}\n\n/* File Section */\n.file-section {\n  background: #f9fafb;\n  padding: 12px 16px;\n}\n\n.file-actions {\n  display: flex;\n  gap: 6px;\n  justify-content: space-between;\n}\n\n.icon-btn {\n  flex: 1;\n  padding: 10px 8px;\n  border: 1px solid #d1d5db;\n  border-radius: 6px;\n  background: #fff;\n  font-size: 18px;\n  cursor: pointer;\n  transition: all 0.2s;\n}\n\n.icon-btn:hover {\n  background: #f3f4f6;\n  border-color: #9ca3af;\n  transform: translateY(-1px);\n}\n\n.icon-btn-danger:hover {\n  background: #fef2f2;\n  border-color: #fca5a5;\n}\n\n/* ===== MAIN & TOOLBAR ===== */\n.main {\n  display: grid;\n  grid-template-rows: 52px 1fr;\n}\n\n.toolbar {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  padding: 8px 16px;\n  border-bottom: 1px solid #e5e7eb;\n  background: #fff;\n}\n\n.toolbar-group {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.toolbar-group-cta {\n  flex: 1;\n  max-width: 500px;\n}\n\n.toolbar-divider {\n  width: 1px;\n  height: 28px;\n  background: #d1d5db;\n}\n\n.toolbar-btn {\n  padding: 6px 12px;\n  border-radius: 6px;\n  border: 1px solid #d1d5db;\n  background: #f9fafb;\n  font-size: 14px;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.2s;\n}\n\n.toolbar-btn:hover {\n  background: #f3f4f6;\n  border-color: #9ca3af;\n}\n\n.quick-add-input {\n  flex: 1;\n  padding: 8px 12px;\n  border: 1px solid #d1d5db;\n  border-radius: 6px;\n  background: #fff;\n  font-family: inherit;\n  font-size: 14px;\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);\n  transition: all 0.2s;\n}\n\n.quick-add-input:focus {\n  outline: none;\n  border-color: #3b82f6;\n  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1), 0 1px 2px rgba(0, 0, 0, 0.05);\n}\n\n.btn-primary {\n  padding: 8px 16px;\n  border: none;\n  border-radius: 6px;\n  background: #3b82f6;\n  color: #fff;\n  font-size: 14px;\n  font-weight: 600;\n  cursor: pointer;\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);\n  transition: all 0.2s;\n}\n\n.btn-primary:hover {\n  background: #2563eb;\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n  transform: translateY(-1px);\n}\n\n.btn-primary:active {\n  transform: translateY(0);\n}\n\n.canvas-wrap {\n  position: relative;\n  background: #fbfbfd;\n}\n\nsvg {\n  width: 100%;\n  height: calc(100vh - 52px);\n  display: block;\n  cursor: grab;\n}\n\nsvg.dragging {\n  cursor: grabbing;\n}\n\n.territory {\n  fill: #f6f7fb;\n  stroke: #e5e7f0;\n  stroke-width: 1.5;\n}\n\n.territory-title {\n  font-size: 13px;\n  fill: #556;\n}\n\n.node {\n  fill: #fff;\n  stroke: #c8cdda;\n  stroke-width: 1.5;\n  filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.08));\n  cursor: move;\n  transition: stroke 0.2s;\n}\n\n.node:hover {\n  stroke: #8b90a8;\n}\n\n.node.selected {\n  stroke: #4f46e5;\n  stroke-width: 2;\n}\n\n.node-label {\n  font-size: 12px;\n  fill: #334;\n  pointer-events: none;\n}\n\n.edge {\n  stroke: #b9bfd2;\n  stroke-width: 1.25;\n  marker-end: url(#arrow);\n}\n\n.inspector {\n  position: absolute;\n  right: 20px;\n  top: 20px;\n  width: 380px;\n  max-height: calc(100vh - 80px);\n  background: #fdfcfb;\n  border: 1px solid #e7e5e1;\n  border-radius: 12px;\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08), 0 2px 8px rgba(0, 0, 0, 0.04);\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n  animation: inspectorFadeIn 0.25s cubic-bezier(0.16, 1, 0.3, 1);\n}\n\n@keyframes inspectorFadeIn {\n  from {\n    opacity: 0;\n    transform: translateY(-8px) scale(0.98);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0) scale(1);\n  }\n}\n\n.inspector-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 18px 20px;\n  border-bottom: 1px solid #ede9e3;\n  background: #fdfcfb;\n}\n\n.inspector-header h3 {\n  margin: 0;\n  font-size: 17px;\n  font-weight: 500;\n  color: #2d2a26;\n  letter-spacing: -0.01em;\n}\n\n.btn-icon {\n  width: 28px;\n  height: 28px;\n  border: none;\n  border-radius: 6px;\n  background: transparent;\n  cursor: pointer;\n  font-size: 16px;\n  color: #847e75;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.18s cubic-bezier(0.16, 1, 0.3, 1);\n}\n\n.btn-icon:hover {\n  background: #f4f1ed;\n  color: #2d2a26;\n  transform: scale(1.05);\n}\n\n.field-group {\n  padding: 16px 20px;\n  border-bottom: 1px solid #f4f1ed;\n}\n\n.field-group:last-of-type {\n  border-bottom: none;\n}\n\n.field-group.field-notes {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  min-height: 0;\n}\n\n.field-label {\n  display: block;\n  font-size: 13px;\n  font-weight: 500;\n  color: #6b6560;\n  margin-bottom: 8px;\n  letter-spacing: -0.005em;\n}\n\n.field-group input[type=\"text\"],\n.field-group textarea,\n.field-group select {\n  width: 100%;\n  padding: 10px 12px;\n  border: 1px solid #e7e5e1;\n  border-radius: 8px;\n  font-family: inherit;\n  font-size: 14px;\n  color: #2d2a26;\n  background: #ffffff;\n  transition: all 0.2s cubic-bezier(0.16, 1, 0.3, 1);\n}\n\n.field-group input:focus,\n.field-group textarea:focus,\n.field-group select:focus {\n  outline: none;\n  border-color: #c49a6c;\n  box-shadow: 0 0 0 3px rgba(196, 154, 108, 0.12);\n  background: #ffffff;\n}\n\n.field-group textarea {\n  resize: vertical;\n  min-height: 180px;\n  line-height: 1.6;\n  flex: 1;\n}\n\n.field-group textarea::placeholder {\n  color: #b5aca3;\n}\n\n.inspector-footer {\n  padding: 14px 20px;\n  background: #faf9f7;\n  border-top: 1px solid #ede9e3;\n}\n\n.timestamp {\n  font-size: 12px;\n  color: #9a8f85;\n  letter-spacing: -0.005em;\n}\n\n.badge {\n  display: inline-flex;\n  align-items: center;\n  gap: 6px;\n  padding: 4px 8px;\n  border: 1px solid #ddd;\n  border-radius: 999px;\n  font-size: 12px;\n  background: #fff;\n}\n\n.muted {\n  color: #667085;\n  font-size: 12px;\n}\n\n.error-banner {\n  position: fixed;\n  bottom: 20px;\n  left: 50%;\n  transform: translateX(-50%);\n  background: #fee;\n  color: #c33;\n  padding: 12px 20px;\n  border-radius: 8px;\n  border: 1px solid #fcc;\n  cursor: pointer;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n  z-index: 1000;\n  animation: slideUp 0.3s ease;\n}\n\n@keyframes slideUp {\n  from {\n    opacity: 0;\n    transform: translateX(-50%) translateY(20px);\n  }\n  to {\n    opacity: 1;\n    transform: translateX(-50%) translateY(0);\n  }\n}\n\n/* Context Menu */\n.context-menu {\n  position: fixed;\n  background: white;\n  border: 1px solid #e5e7eb;\n  border-radius: 8px;\n  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15), 0 4px 8px rgba(0, 0, 0, 0.08);\n  padding: 4px;\n  min-width: 200px;\n  z-index: 9999;\n  animation: contextMenuSlide 0.15s ease-out;\n}\n\n@keyframes contextMenuSlide {\n  from {\n    opacity: 0;\n    transform: translateY(-8px) scale(0.95);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0) scale(1);\n  }\n}\n\n.context-menu-item {\n  width: 100%;\n  padding: 10px 14px;\n  border: none;\n  background: transparent;\n  text-align: left;\n  cursor: pointer;\n  border-radius: 6px;\n  font-size: 14px;\n  font-family: inherit;\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  transition: background 0.15s ease;\n  color: #1f2937;\n}\n\n.context-menu-item:hover {\n  background: #f3f4f6;\n}\n\n.context-menu-item.danger {\n  color: #dc2626;\n}\n\n.context-menu-item.danger:hover {\n  background: #fef2f2;\n}\n\n.context-menu-item .icon {\n  font-size: 16px;\n  width: 20px;\n  text-align: center;\n}\n</style>\n","/**\n * Main entry point for Character Canvas Vue application\n * Initializes Vue 3 app with composable architecture\n */\nimport { createApp } from 'vue';\nimport App from './App.vue';\nimport './style.css';\n\n// Global error handler\nconst handleGlobalError = (err, instance, info) => {\n  console.error('Global Error:', err);\n  console.error('Component:', instance);\n  console.error('Error Info:', info);\n\n  // You can send to error tracking service here\n  // Example: Sentry.captureException(err);\n};\n\n// Create and configure Vue app\nconst app = createApp(App);\n\n// Register global error handler\napp.config.errorHandler = handleGlobalError;\n\n// Production tip (disable in production)\napp.config.performance = true;\n\n// Mount app\ntry {\n  app.mount('#app');\n  console.log('‚úì Character Canvas initialized successfully');\n} catch (error) {\n  console.error('Failed to mount Vue app:', error);\n  document.querySelector('#app').innerHTML = `\n    <div style=\"padding: 20px; font-family: system-ui;\">\n      <h1 style=\"color: #c33;\">Application Failed to Load</h1>\n      <p>An error occurred while initializing the application.</p>\n      <pre style=\"background: #f5f5f5; padding: 10px; border-radius: 4px; overflow: auto;\">\n${error.stack || error.message}\n      </pre>\n      <button onclick=\"location.reload()\" style=\"padding: 10px 20px; border-radius: 6px; border: none; background: #111; color: #fff; cursor: pointer;\">\n        Reload Page\n      </button>\n    </div>\n  `;\n}\n"],"names":["PRIMARY_KEY","BACKUP_KEY","MAX_DATA_SIZE","saveTimeout","validateData","data","jsonStr","sizeBytes","error","saveToStorage","existingPrimary","loadFromStorage","debouncedAutoSave","immediateAutoSave","loadSavedState","exportData","blob","url","filename","link","importData","file","resolve","reject","reader","e","territories","reactive","nodes","edges","chatInput","ref","isGenerating","swot","getStateSnapshot","autoSave","state","immediateSave","autoLoad","t","n","exportState","exportDataFile","importState","importDataFile","saveSnapshot","name","raw","history","loadSnapshot","index","snap","TERRITORY_PADDING","TERRITORY_HEADER","NODE_WIDTH","NODE_HEIGHT","NODE_SPACING_X","NODE_SPACING_Y","COLS_PER_TERRITORY","TERRITORY_SPACING","TERRITORY_COLS","calculateTerritoryDimensions","nodeCount","rows","width","height","positionNodeInTerritory","node","territory","indexInTerritory","col","row","x","y","maxX","maxY","finalX","finalY","deleteNode","nodeId","nodeIndex","edgesToRemove","edge","edgeIndex","idIndex","runAnalysis","generateMap","response","errorData","errorMessage","_a","mapData","llmNodes","llmEdges","dimensions","nodesPositioned","nodesOutside","position","userMessage","useState","initView","viewBox","isPanning","lastPan","svgToWorld","svg","r","px","py","worldToScreen","sx","sy","onPanStart","onPanMove","dx","dy","onPanEnd","onWheel","event","rect","mouseX","mouseY","scaleFactor","worldMx","worldMy","newW","newH","zoomToNode","scale","duration","start","cx","cy","targetW","targetH","target","t0","step","p","useCanvas","selectedNode","quickNodeLabel","editingNode","dragging","nodeById","id","selectNode","deselectNode","quickAddNode","label","newNode","onNodeDragStart","onNodeDragMove","onNodeDragEnd","newX","newY","minX","minY","useNodes","_sfc_main","swotExpanded","handleError","err","context","clearError","contextMenu","onErrorCaptured","instance","info","stateComposable","canvasComposable","nodesComposable","zoomPercentage","computed","handleSave","handleLoad","handleReset","handleExport","handleImport","input","handleNodeUpdate","onNodeRightClick","closeContextMenu","handleDeleteNode","formatTimestamp","ts","date","diffMs","diffMins","zoomAtCenter","factor","centerView","onMounted","handleGlobalClick","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_5","_hoisted_10","_hoisted_11","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_23","_hoisted_24","_hoisted_33","_hoisted_34","_hoisted_35","_hoisted_36","_hoisted_37","_hoisted_38","_openBlock","_createElementBlock","_createElementVNode","_cache","$setup","$event","args","_hoisted_6","_hoisted_9","_toDisplayString","_hoisted_12","_vModelText","_hoisted_22","_Fragment","_renderList","_hoisted_27","_b","_c","_d","_withModifiers","_normalizeClass","_hoisted_31","_hoisted_32","_vModelSelect","_normalizeStyle","_createTextVNode","handleGlobalError","app","createApp","App"],"mappings":"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"}