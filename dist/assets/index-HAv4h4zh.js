import{r as A,a as y,c as N,b as r,d as z,w as k,v as D,e as ge,t as T,f as no,g as F,n as me,F as $,h as ee,i as so,j as ro,o as ao,k as io,l as lo,m as S,p as co}from"./vue-vendor-DvzjMVvK.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function s(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(a){if(a.ep)return;a.ep=!0;const l=s(a);fetch(a.href,l)}})();const oe="hikki-canvas-state",ve="hikki-canvas-state-backup",pe=50*1024*1024;let U=null;function Y(t){try{if(!t||typeof t!="object")return console.error("🚫 Validation failed: Data is not an object"),!1;if(!Array.isArray(t.territories)||!Array.isArray(t.nodes)||!Array.isArray(t.edges))return console.error("🚫 Validation failed: Missing required arrays"),!1;const e=JSON.stringify(t),s=new Blob([e]).size;return s>pe?(console.error(`🚫 Validation failed: Data exceeds ${pe/1024/1024}MB limit`),!1):(console.log(`✓ Validation passed (${(s/1024).toFixed(2)}KB)`),!0)}catch(e){return console.error("🚫 Validation error:",e),!1}}function ne(t){try{if(!Y(t))return!1;const e=JSON.stringify(t),s=localStorage.getItem(oe);return s&&(localStorage.setItem(ve,s),console.log("🔄 Rotated primary to backup")),localStorage.setItem(oe,e),console.log(`💾 Saved to primary storage (${t.nodes.length} nodes, ${t.edges.length} edges)`),!0}catch(e){return console.error("❌ Save failed:",e),!1}}function uo(){try{let t=localStorage.getItem(oe);if(t)try{const e=JSON.parse(t);if(Y(e))return console.log(`✅ Loaded from primary storage (${e.nodes.length} nodes)`),e}catch{console.warn("⚠️ Primary storage corrupted, trying backup...")}if(t=localStorage.getItem(ve),t)try{const e=JSON.parse(t);if(Y(e))return console.log(`✅ Recovered from backup storage (${e.nodes.length} nodes)`),ne(e),e}catch{console.error("❌ Backup storage also corrupted")}return console.log("ℹ️ No saved data found"),null}catch(t){return console.error("❌ Load failed:",t),null}}function fo(t){U&&clearTimeout(U),U=setTimeout(()=>{console.log("⏱️ Debounced save triggered"),ne(t)},500)}function go(t){return U&&(clearTimeout(U),U=null),console.log("⚡ Immediate save triggered"),ne(t)}function mo(){return uo()}function po(t){try{if(!Y(t))throw new Error("Invalid data structure");const e=JSON.stringify(t,null,2),s=new Blob([e],{type:"application/json"}),o=URL.createObjectURL(s),l=`hikki-notes-${new Date().toISOString().split("T")[0]}.json`,c=document.createElement("a");c.href=o,c.download=l,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(o),console.log(`📥 Exported data as ${l}`)}catch(e){throw console.error("❌ Export failed:",e),e}}function yo(t){return new Promise((e,s)=>{const o=new FileReader;o.onload=a=>{try{const l=JSON.parse(a.target.result);if(!Y(l)){s(new Error("Invalid file structure"));return}console.log(`📤 Imported data (${l.nodes.length} nodes, ${l.edges.length} edges)`),e(l)}catch(l){console.error("❌ Import failed:",l),s(l)}},o.onerror=()=>{s(new Error("File read failed"))},o.readAsText(t)})}const v=A([]),m=A([]),b=A([]),se=y(""),j=y(!1),W=A({strengths:"",weaknesses:"",opportunities:"",threats:""});function re(){return{territories:JSON.parse(JSON.stringify(v)),nodes:JSON.parse(JSON.stringify(m)),edges:JSON.parse(JSON.stringify(b)),timestamp:Date.now()}}function ho(){const t=re();fo(t)}function q(){const t=re();go(t)}function wo(){try{const t=mo();return t?(v.splice(0),m.splice(0),b.splice(0),(t.territories||[]).forEach(e=>v.push(e)),(t.nodes||[]).forEach(e=>m.push(e)),(t.edges||[]).forEach(e=>b.push(e)),console.log("✅ State loaded from",new Date(t.timestamp).toLocaleString()),!0):(console.log("ℹ️ No saved state found, will generate initial map"),!1)}catch(t){return console.error("❌ Auto-load failed:",t),!1}}function xo(){try{const t=re();po(t),console.log("✓ State exported successfully")}catch(t){throw console.error("❌ Export failed:",t),t}}async function vo(t){try{const e=await yo(t);v.splice(0),m.splice(0),b.splice(0),(e.territories||[]).forEach(s=>v.push(s)),(e.nodes||[]).forEach(s=>m.push(s)),(e.edges||[]).forEach(s=>b.push(s)),q(),console.log("✓ State imported successfully")}catch(e){throw console.error("❌ Import failed:",e),e}}function be(t){try{const e=localStorage.getItem("mvp-history"),s=e?JSON.parse(e):[],o={territories:JSON.parse(JSON.stringify(v)),nodes:JSON.parse(JSON.stringify(m)),edges:JSON.parse(JSON.stringify(b)),swot:{...W},ts:Date.now(),name:t};s.push({id:crypto.randomUUID(),ts:Date.now(),name:t||`snap-${s.length+1}`,data:o}),localStorage.setItem("mvp-history",JSON.stringify(s))}catch(e){throw console.error("Failed to save snapshot:",e),new Error(`Snapshot save failed: ${e.message}`)}}function bo(t){try{const e=localStorage.getItem("mvp-history");if(!e)throw new Error("No saved history found");const o=JSON.parse(e)[t];if(!o||!o.data)throw new Error(`Invalid snapshot at index ${t}`);v.splice(0),m.splice(0),b.splice(0),(o.data.territories||[]).forEach(a=>v.push(a)),(o.data.nodes||[]).forEach(a=>m.push(a)),(o.data.edges||[]).forEach(a=>b.push(a)),o.data.swot&&Object.assign(W,o.data.swot)}catch(e){throw console.error("Failed to load snapshot:",e),new Error(`Snapshot load failed: ${e.message}`)}}const R=20,Ne=60,H=180,_=80,Se=20,Ee=20,V=2,ye=50,he=3;function No(t){const e=Math.ceil(t/V),s=R*2+V*H+(V-1)*Se,o=Ne+R*2+e*_+(e-1)*Ee;return{width:Math.max(s,400),height:Math.max(o,350)}}function So(t,e,s){const o=s%V,a=Math.floor(s/V),l=e.x+R+o*(H+Se),c=e.y+Ne+R+a*(_+Ee),n=e.x+e.w-H-R,i=e.y+e.h-_-R,u=Math.min(l,n),g=Math.min(c,i);return(l!==u||c!==g)&&console.warn(`⚠️ Node "${t.label}" clamped in territory "${e.label}":`,{original:{x:l,y:c},clamped:{x:u,y:g},territory:{bounds:{x:e.x,y:e.y,w:e.w,h:e.h},maxAllowed:{x:n,y:i}}}),{x:u,y:g}}function Eo(t){try{const e=m.findIndex(a=>a.id===t);if(e===-1)return console.warn(`Node ${t} not found`),!1;const s=m[e];console.log(`🗑️ Deleting node "${s.label}" (${t})`),m.splice(e,1);const o=b.filter(a=>a.source===t||a.target===t);return o.forEach(a=>{const l=b.findIndex(c=>c.id===a.id);l!==-1&&(b.splice(l,1),console.log(`  → Removed edge ${a.id}`))}),v.forEach(a=>{if(a.nodeIds&&a.nodeIds.includes(t)){const l=a.nodeIds.indexOf(t);a.nodeIds.splice(l,1),console.log(`  → Removed from territory "${a.label}"`)}}),q(),console.log(`✅ Node deleted successfully (${o.length} edges removed)`),!0}catch(e){return console.error("Failed to delete node:",e),!1}}function Io(){se.value.toLowerCase().includes("ielts")?(W.strengths="Good listening",W.weaknesses="Timing in writing"):W.strengths="Creative",alert("SWOT drafted (stub).")}async function ko(){var t;if(j.value){console.warn("Map generation already in progress");return}try{j.value=!0,console.log("🚀 Starting map generation..."),v.splice(0),m.splice(0),b.splice(0);const e=await fetch("/api/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:se.value||"Create a learning plan for IELTS preparation with listening, reading, writing, and speaking skills"})});if(!e.ok){const i=await e.json().catch(()=>null),u=(i==null?void 0:i.error)||`Server error: ${e.status}`;throw new Error(u)}const s=await e.json();if(!s.success)throw new Error(s.error||"Map generation failed");(t=s.metadata)!=null&&t.fallback&&(console.warn("⚠️ Using fallback map - LLM response was invalid"),alert("Warning: Map generation used fallback mode. Results may be limited."));const o=s.data,a=o.nodes.map(i=>({id:i.id||crypto.randomUUID(),label:i.label,type:i.type||"concept",note:"",status:"todo",timestamp:Date.now()})),l=o.edges.map(i=>({id:i.id||crypto.randomUUID(),source:i.source,target:i.target,type:i.type||"relationship"}));a.forEach(i=>m.push(i)),l.forEach(i=>b.push(i)),o.territories&&o.territories.length>0&&(console.log("🗺️ Creating territories with dynamic sizing..."),o.territories.forEach((i,u)=>{const g=(i.nodeIds||[]).length,h=No(g),E=u%he,C=Math.floor(u/he),O={id:i.id||crypto.randomUUID(),label:i.name,x:100+E*(h.width+ye),y:100+C*(h.height+ye),w:h.width,h:h.height,nodeIds:i.nodeIds||[]};v.push(O),console.log(`  📦 Territory "${O.label}":`,{nodes:g,dimensions:{w:h.width,h:h.height},position:{x:O.x,y:O.y}})})),console.log(`
📍 Positioning nodes within territories...`);let c=0,n=0;m.forEach(i=>{const u=v.find(g=>g.nodeIds&&g.nodeIds.includes(i.id));if(u){const g=u.nodeIds.indexOf(i.id),h=So(i,u,g);i.x=h.x,i.y=h.y,c++,i.x>=u.x&&i.x+H<=u.x+u.w&&i.y>=u.y&&i.y+_<=u.y+u.h||console.error(`❌ Node "${i.label}" STILL outside territory "${u.label}"!`,{node:{x:i.x,y:i.y},territory:{x:u.x,y:u.y,w:u.w,h:u.h}})}else i.x=Math.random()*800+100,i.y=Math.random()*600+100,n++,console.warn(`⚠️ Node "${i.label}" has no territory assignment`)}),console.log(`✓ Positioned ${c} nodes, ${n} outside territories`),be("auto-generate"),q(),console.log("✅ Map generation complete!"),console.log(`   → ${v.length} territories`),console.log(`   → ${m.length} nodes`),console.log(`   → ${b.length} edges`)}catch(e){console.error("❌ Map generation failed:",e);let s="Failed to generate map. ";throw e.message.includes("Rate limit")||e.message.includes("busy")?s+="The AI service is currently busy. Please wait a moment and try again.":e.message.includes("API key")||e.message.includes("not configured")?s+="API configuration error. Please check your API keys.":e.message.includes("Invalid map structure")?s+="The AI returned an invalid response. Please try a different prompt.":s+=e.message,alert(s),e}finally{j.value=!1}}function Co(){return{territories:v,nodes:m,edges:b,chatInput:se,swot:W,isGenerating:j,saveSnapshot:be,loadSnapshot:bo,runAnalysis:Io,generateMap:ko,autoSave:ho,immediateSave:q,autoLoad:wo,deleteNode:Eo,exportState:xo,importState:vo}}const L=A({x:0,y:0,w:1600,h:900}),f=A({x:L.x,y:L.y,w:L.w,h:L.h}),K=y(!1),B=A({x:0,y:0});function ae(t){const e=document.querySelector("svg");if(!e)return console.warn("SVG element not found"),{x:0,y:0};const s=e.getBoundingClientRect(),o=(t.clientX-s.left)/s.width,a=(t.clientY-s.top)/s.height;return{x:f.x+o*f.w,y:f.y+a*f.h}}function Mo(t){const e=document.querySelector("svg");if(!e)return console.warn("SVG element not found"),{x:0,y:0,rect:null};const s=e.getBoundingClientRect(),o=(t.x-f.x)/f.w*s.width+s.left,a=(t.y-f.y)/f.h*s.height+s.top;return{x:o,y:a,rect:s}}function Do(t){K.value=!0,B.x=t.clientX,B.y=t.clientY}function To(t){if(!K.value)return;const e=t.currentTarget,s=(t.clientX-B.x)*(f.w/e.clientWidth),o=(t.clientY-B.y)*(f.h/e.clientHeight);f.x-=s,f.y-=o,B.x=t.clientX,B.y=t.clientY}function Ao(){K.value=!1}const Oo=t=>{const s=t.currentTarget.getBoundingClientRect(),o=t.clientX-s.left,a=t.clientY-s.top,l=t.deltaY<0?.9:1.1,c=f.x+o/s.width*f.w,n=f.y+a/s.height*f.h,i=f.w*l,u=f.h*l;f.x=c-o/s.width*i,f.y=n-a/s.height*u,f.w=i,f.h=u};function Po(t,e=2,s=300){const o={x:f.x,y:f.y,w:f.w,h:f.h},a=t.x,l=t.y,c=L.w/e,n=L.h/e,i={x:a-c/2,y:l-n/2,w:c,h:n},u=performance.now();function g(h){const E=Math.min(1,(h-u)/s),C=1-Math.pow(1-E,2);f.x=o.x+(i.x-o.x)*C,f.y=o.y+(i.y-o.y)*C,f.w=o.w+(i.w-o.w)*C,f.h=o.h+(i.h-o.h)*C,E<1&&requestAnimationFrame(g)}requestAnimationFrame(g)}function Ro(){return{viewBox:f,isPanning:K,onPanStart:Do,onPanMove:To,onPanEnd:Ao,onWheel:Oo,svgToWorld:ae,worldToScreen:Mo,zoomToNode:Po}}const we=180,xe=80,X=20,ie=y(null),te=y(""),le=y(null),x=A({active:!1,id:null,ox:0,oy:0});function Lo(t){return m.find(e=>e.id===t)}function Bo(t){ie.value=t,le.value=t}function Uo(){ie.value=null,le.value=null}function Wo(){const t=te.value.trim();if(!t){console.warn("Cannot add node with empty label");return}const s={id:crypto.randomUUID(),label:t,x:f.x+f.w/2,y:f.y+f.h/2,territoryId:null,note:"",status:"todo",timestamp:Date.now()};m.push(s),te.value=""}const Jo=(t,e)=>{t.stopPropagation();const s=ae(t);x.active=!0,x.id=e.id,x.ox=s.x-e.x,x.oy=s.y-e.y,window.addEventListener("mousemove",de),window.addEventListener("mouseup",ce)},de=t=>{if(!x.active||!x.id)return;const e=ae(t),s=m.find(c=>c.id===x.id);if(!s)return;let o=e.x-x.ox,a=e.y-x.oy;const l=v.find(c=>c.nodeIds&&c.nodeIds.includes(s.id));if(l){const c=l.x+X,n=l.y+60+X,i=l.x+l.w-we/2-X,u=l.y+l.h-xe/2-X;o=Math.max(c+we/2,Math.min(o,i)),a=Math.max(n+xe/2,Math.min(a,u)),(o!==e.x-x.ox||a!==e.y-x.oy)&&!s._boundaryWarned&&(console.log(`🚧 Node "${s.label}" constrained to territory "${l.label}"`),s._boundaryWarned=!0)}s.x=o,s.y=a},ce=t=>{if(x.id){const e=m.find(s=>s.id===x.id);e&&delete e._boundaryWarned}x.active=!1,x.id=null,window.removeEventListener("mousemove",de),window.removeEventListener("mouseup",ce),q()};function Vo(){return{selectedNode:ie,quickNodeLabel:te,editingNode:le,dragging:x,nodeById:Lo,selectNode:Bo,deselectNode:Uo,quickAddNode:Wo,onNodeDragStart:Jo,onNodeDragMove:de,onNodeDragEnd:ce}}const Yo=(t,e)=>{const s=t.__vccOpts||t;for(const[o,a]of e)s[o]=a;return s},qo={name:"App",setup(){const t=y(!1),e=y(null),s=(d,p="")=>{console.error(`[App Error] ${p}:`,d),e.value=`${p}: ${d.message||d}`,setTimeout(()=>{e.value=null},5e3)},o=()=>{e.value=null},a=y({visible:!1,x:0,y:0,node:null});ao((d,p,I)=>(s(d,`Component error (${I})`),!1));let l,c,n;try{l=Co(),c=Ro(),n=Vo()}catch(d){s(d,"Composable initialization failed"),l={territories:y([]),nodes:y([]),edges:y([]),chatInput:y(""),swot:y({})},c={viewBox:y({x:0,y:0,w:1600,h:900}),isPanning:y(!1)},n={selectedNode:y(null),quickNodeLabel:y("")}}const{territories:i,nodes:u,edges:g,chatInput:h,swot:E,isGenerating:C,runAnalysis:O,generateMap:G,saveSnapshot:Ie,loadSnapshot:ke,autoLoad:Z,deleteNode:Ce,autoSave:Me,exportState:De,importState:Te}=l,{viewBox:w,isPanning:Ae,onPanStart:Oe,onPanMove:Pe,onPanEnd:Re,onWheel:Le,svgToWorld:Tt,worldToScreen:At,zoomToNode:Be}=c,{selectedNode:J,quickNodeLabel:Ue,editingNode:We,dragging:Ot,nodeById:Je,selectNode:Ve,deselectNode:fe,quickAddNode:Ye,onNodeDragStart:qe,onNodeDragMove:Ge,onNodeDragEnd:ze}=n,Fe=io(()=>(100*(1600/w.w)).toFixed(0)),Xe=()=>{try{Ie(`manual-${Date.now()}`),console.log("✓ State saved successfully")}catch(d){s(d,"Save failed")}},je=()=>{try{ke(0),console.log("✓ State loaded successfully")}catch(d){s(d,"Load failed")}},He=()=>{try{confirm("Reset all data? This cannot be undone.")&&(i.splice(0),u.splice(0),g.splice(0),h.value="",E.strengths="",E.weaknesses="",E.opportunities="",E.threats="",console.log("✓ Reset complete"))}catch(d){s(d,"Reset failed")}},_e=()=>{try{De(),console.log("✓ Export successful")}catch(d){s(d,"Export failed")}},Ke=()=>{try{const d=document.createElement("input");d.type="file",d.accept="application/json",d.onchange=async p=>{const I=p.target.files[0];if(I)try{await Te(I),console.log("✓ Import successful")}catch(P){s(P,"Import failed")}},d.click()}catch(d){s(d,"Import failed")}},Ze=()=>{J.value&&(console.log("📝 Node edit detected:",J.value.label),Me())},Qe=(d,p)=>{try{d.preventDefault(),d.stopPropagation(),a.value={visible:!0,x:d.clientX,y:d.clientY,node:p}}catch(I){s(I,"Context menu failed")}},Q=()=>{a.value.visible=!1,a.value.node=null},$e=()=>{try{const d=a.value.node;if(!d)return;J.value&&J.value.id===d.id&&fe(),Ce(d.id)||s(new Error("Failed to delete node"),"Delete failed"),Q()}catch(d){s(d,"Delete node failed")}},eo=d=>{if(!d)return"";const p=new Date(d),P=new Date-p,M=Math.floor(P/6e4);return M<1?"Just now":M<60?`${M}m ago`:M<1440?`${Math.floor(M/60)}h ago`:p.toLocaleDateString()},oo=d=>{try{const p=w.x+w.w/2,I=w.y+w.h/2,P=w.w/d,M=w.h/d;w.x=p-P/2,w.y=I-M/2,w.w=P,w.h=M}catch(p){s(p,"Zoom failed")}},to=()=>{try{w.x=0,w.y=0,w.w=1600,w.h=900}catch(d){s(d,"Center view failed")}};return lo(()=>{try{!(Z&&typeof Z=="function"&&Z())&&G&&typeof G=="function"&&(console.log("No saved state, generating initial map..."),G());const p=I=>{a.value.visible&&!I.target.closest(".context-menu")&&Q()};return document.addEventListener("click",p),()=>{document.removeEventListener("click",p)}}catch(d){s(d,"Initialization failed")}}),{swotExpanded:t,chatInput:h,swot:E,isGenerating:C,territories:i,nodes:u,edges:g,selectedNode:J,quickNodeLabel:Ue,editingNode:We,contextMenu:a,viewBox:w,isPanning:Ae,zoomPercentage:Fe,runAnalysis:O,generateMap:G,handleSave:Xe,handleLoad:je,handleReset:He,handleExport:_e,handleImport:Ke,handleNodeUpdate:Ze,onNodeRightClick:Qe,closeContextMenu:Q,handleDeleteNode:$e,onWheel:Le,onPanStart:Oe,onPanMove:Pe,onPanEnd:Re,onNodeDragStart:qe,onNodeDragMove:Ge,onNodeDragEnd:ze,nodeById:Je,selectNode:Ve,deselectNode:fe,quickAddNode:Ye,zoomToNode:Be,zoomAtCenter:oo,centerView:to,formatTimestamp:eo,error:e,clearError:o}}},Go={class:"app"},zo={class:"sidebar"},Fo={class:"sidebar-section chat-section"},Xo=["disabled"],jo={class:"button-row"},Ho=["disabled"],_o=["disabled"],Ko={key:0},Zo={key:1,class:"spinner-row"},Qo={class:"sidebar-section swot-section"},$o={class:"toggle-icon"},et={key:0,class:"swot-grid"},ot={class:"swot-quadrant"},tt={class:"swot-quadrant"},nt={class:"swot-quadrant"},st={class:"swot-quadrant"},rt={class:"sidebar-section file-section"},at={class:"file-actions"},it={class:"main"},lt={class:"toolbar"},dt={class:"toolbar-group"},ct={class:"badge",title:"Current zoom level"},ut={class:"toolbar-group toolbar-group-cta"},ft={class:"canvas-wrap"},gt=["viewBox"],mt=["x","y","width","height"],pt=["x","y"],yt=["x1","y1","x2","y2"],ht=["onMousedown","onDblclick","onContextmenu"],wt=["x","y"],xt=["x","y"],vt={key:0,class:"inspector"},bt={class:"inspector-header"},Nt={class:"field-group"},St={class:"field-group"},Et={class:"field-group field-notes"},It={class:"inspector-footer"},kt={class:"timestamp"};function Ct(t,e,s,o,a,l){var c;return S(),N("div",Go,[r("aside",zo,[r("section",Fo,[e[35]||(e[35]=r("h2",{class:"section-title"},"Character Chat ▸ Needs",-1)),k(r("textarea",{"onUpdate:modelValue":e[0]||(e[0]=n=>o.chatInput=n),disabled:o.isGenerating,placeholder:"e.g. I want to prepare for IELTS in 8 weeks; I struggle with timing and writing Task 1...",class:"chat-textarea"},null,8,Xo),[[D,o.chatInput]]),r("div",jo,[r("button",{class:"btn btn-action",onClick:e[1]||(e[1]=(...n)=>o.runAnalysis&&o.runAnalysis(...n)),disabled:o.isGenerating}," Analyze SWOT ",8,Ho),r("button",{class:"btn btn-action",onClick:e[2]||(e[2]=(...n)=>o.generateMap&&o.generateMap(...n)),disabled:o.isGenerating},[o.isGenerating?(S(),N("span",Zo,[...e[34]||(e[34]=[r("span",{class:"spinner"},null,-1),ge(" Generating... ",-1)])])):(S(),N("span",Ko,"Generate Map"))],8,_o)])]),r("section",Qo,[r("button",{class:"section-toggle",onClick:e[3]||(e[3]=n=>o.swotExpanded=!o.swotExpanded)},[r("span",$o,T(o.swotExpanded?"▼":"▶"),1),e[36]||(e[36]=r("h2",{class:"section-title-inline"},"SWOT Analysis",-1))]),o.swotExpanded?(S(),N("div",et,[r("div",ot,[e[37]||(e[37]=r("label",{class:"swot-label"},"Strengths",-1)),k(r("textarea",{"onUpdate:modelValue":e[4]||(e[4]=n=>o.swot.strengths=n),rows:"3"},null,512),[[D,o.swot.strengths]])]),r("div",tt,[e[38]||(e[38]=r("label",{class:"swot-label"},"Weaknesses",-1)),k(r("textarea",{"onUpdate:modelValue":e[5]||(e[5]=n=>o.swot.weaknesses=n),rows:"3"},null,512),[[D,o.swot.weaknesses]])]),r("div",nt,[e[39]||(e[39]=r("label",{class:"swot-label"},"Opportunities",-1)),k(r("textarea",{"onUpdate:modelValue":e[6]||(e[6]=n=>o.swot.opportunities=n),rows:"3"},null,512),[[D,o.swot.opportunities]])]),r("div",st,[e[40]||(e[40]=r("label",{class:"swot-label"},"Threats",-1)),k(r("textarea",{"onUpdate:modelValue":e[7]||(e[7]=n=>o.swot.threats=n),rows:"3"},null,512),[[D,o.swot.threats]])])])):z("",!0)]),r("section",rt,[r("div",at,[r("button",{class:"icon-btn",onClick:e[8]||(e[8]=(...n)=>o.handleSave&&o.handleSave(...n)),title:"Save current state"}," 💾 "),r("button",{class:"icon-btn",onClick:e[9]||(e[9]=(...n)=>o.handleLoad&&o.handleLoad(...n)),title:"Load saved state"}," 📂 "),r("button",{class:"icon-btn",onClick:e[10]||(e[10]=(...n)=>o.handleExport&&o.handleExport(...n)),title:"Export as JSON"}," 📥 "),r("button",{class:"icon-btn",onClick:e[11]||(e[11]=(...n)=>o.handleImport&&o.handleImport(...n)),title:"Import from JSON"}," 📤 "),r("button",{class:"icon-btn icon-btn-danger",onClick:e[12]||(e[12]=(...n)=>o.handleReset&&o.handleReset(...n)),title:"Reset all data"}," 🗑️ ")])])]),r("main",it,[r("div",lt,[r("div",dt,[r("span",ct,"Zoom: "+T(o.zoomPercentage)+"%",1),r("button",{class:"btn toolbar-btn",onClick:e[13]||(e[13]=()=>o.zoomAtCenter(1.2)),title:"Zoom in"},"+"),r("button",{class:"btn toolbar-btn",onClick:e[14]||(e[14]=()=>o.zoomAtCenter(1/1.2)),title:"Zoom out"},"−"),r("button",{class:"btn toolbar-btn",onClick:e[15]||(e[15]=(...n)=>o.centerView&&o.centerView(...n)),title:"Reset view to center"},"Center")]),e[41]||(e[41]=r("div",{class:"toolbar-divider"},null,-1)),r("div",ut,[k(r("input",{type:"text",placeholder:"Quick add node...","onUpdate:modelValue":e[16]||(e[16]=n=>o.quickNodeLabel=n),onKeydown:e[17]||(e[17]=no((...n)=>o.quickAddNode&&o.quickAddNode(...n),["enter"])),class:"quick-add-input",title:"Type a label and press Enter or click Add Node"},null,544),[[D,o.quickNodeLabel]]),r("button",{class:"btn btn-primary",onClick:e[18]||(e[18]=(...n)=>o.quickAddNode&&o.quickAddNode(...n)),title:"Add new node to canvas"}," + Add Node ")])]),r("section",ft,[(S(),N("svg",{class:me({dragging:o.isPanning}),viewBox:`${o.viewBox.x} ${o.viewBox.y} ${o.viewBox.w} ${o.viewBox.h}`,onMousedown:e[19]||(e[19]=(...n)=>o.onPanStart&&o.onPanStart(...n)),onMousemove:e[20]||(e[20]=(...n)=>o.onPanMove&&o.onPanMove(...n)),onMouseup:e[21]||(e[21]=(...n)=>o.onPanEnd&&o.onPanEnd(...n)),onMouseleave:e[22]||(e[22]=(...n)=>o.onPanEnd&&o.onPanEnd(...n)),onWheel:e[23]||(e[23]=F((...n)=>o.onWheel&&o.onWheel(...n),["prevent"]))},[e[42]||(e[42]=r("defs",null,[r("marker",{id:"arrow",viewBox:"0 0 10 10",refX:"10",refY:"5",markerWidth:"6",markerHeight:"6",orient:"auto-start-reverse"},[r("path",{d:"M 0 0 L 10 5 L 0 10 z",fill:"#b9bfd2"})])],-1)),(S(!0),N($,null,ee(o.territories,n=>(S(),N("g",{key:n.id},[r("rect",{class:"territory",x:n.x,y:n.y,rx:12,ry:12,width:n.w,height:n.h},null,8,mt),r("text",{class:"territory-title",x:n.x+10,y:n.y+18},T(n.label),9,pt)]))),128)),r("g",null,[(S(!0),N($,null,ee(o.edges,n=>{var i,u,g,h;return S(),N("line",{key:n.id,class:"edge",x1:((i=o.nodeById(n.source))==null?void 0:i.x)||0,y1:((u=o.nodeById(n.source))==null?void 0:u.y)||0,x2:((g=o.nodeById(n.target))==null?void 0:g.x)||0,y2:((h=o.nodeById(n.target))==null?void 0:h.y)||0},null,8,yt)}),128))]),(S(!0),N($,null,ee(o.nodes,n=>(S(),N("g",{key:n.id,onMousedown:F(i=>o.onNodeDragStart(i,n),["stop"]),onDblclick:F(()=>o.selectNode(n),["stop"]),onContextmenu:F(i=>o.onNodeRightClick(i,n),["prevent"])},[r("rect",{class:me(["node",o.selectedNode&&o.selectedNode.id===n.id?"selected":""]),x:n.x-60,y:n.y-22,rx:"10",ry:"10",width:"120",height:"44"},null,10,wt),r("text",{class:"node-label",x:n.x,y:n.y+4,"text-anchor":"middle"},T(n.label),9,xt)],40,ht))),128))],42,gt)),o.selectedNode?(S(),N("div",vt,[r("div",bt,[r("h3",null,T(o.selectedNode.label),1),r("button",{class:"btn-icon",onClick:e[24]||(e[24]=(...n)=>o.deselectNode&&o.deselectNode(...n))},"✕")]),r("div",Nt,[e[43]||(e[43]=r("label",{class:"field-label"},"Label",-1)),k(r("input",{"onUpdate:modelValue":e[25]||(e[25]=n=>o.selectedNode.label=n),placeholder:"Node name...",onInput:e[26]||(e[26]=(...n)=>o.handleNodeUpdate&&o.handleNodeUpdate(...n))},null,544),[[D,o.selectedNode.label]])]),r("div",St,[e[45]||(e[45]=r("label",{class:"field-label"},"Status",-1)),k(r("select",{"onUpdate:modelValue":e[27]||(e[27]=n=>o.selectedNode.status=n),onChange:e[28]||(e[28]=(...n)=>o.handleNodeUpdate&&o.handleNodeUpdate(...n))},[...e[44]||(e[44]=[r("option",{value:"todo"},"To Do",-1),r("option",{value:"in-progress"},"In Progress",-1),r("option",{value:"done"},"Done",-1)])],544),[[so,o.selectedNode.status]])]),r("div",Et,[e[46]||(e[46]=r("label",{class:"field-label"},"Notes",-1)),k(r("textarea",{"onUpdate:modelValue":e[29]||(e[29]=n=>o.selectedNode.note=n),placeholder:"Add observations, insights, or leave empty...",onInput:e[30]||(e[30]=(...n)=>o.handleNodeUpdate&&o.handleNodeUpdate(...n))},null,544),[[D,o.selectedNode.note]])]),r("div",It,[r("span",kt,T(o.formatTimestamp(o.selectedNode.timestamp)),1)])])):z("",!0)])]),o.contextMenu.visible?(S(),N("div",{key:0,class:"context-menu",style:ro({left:o.contextMenu.x+"px",top:o.contextMenu.y+"px"})},[r("button",{class:"context-menu-item danger",onClick:e[31]||(e[31]=(...n)=>o.handleDeleteNode&&o.handleDeleteNode(...n))},[e[47]||(e[47]=r("span",{class:"icon"},"🗑️",-1)),ge(' Delete "'+T((c=o.contextMenu.node)==null?void 0:c.label)+'" ',1)]),r("button",{class:"context-menu-item",onClick:e[32]||(e[32]=(...n)=>o.closeContextMenu&&o.closeContextMenu(...n))}," Cancel ")],4)):z("",!0),o.error?(S(),N("div",{key:1,class:"error-banner",onClick:e[33]||(e[33]=(...n)=>o.clearError&&o.clearError(...n))},T(o.error)+" (click to dismiss) ",1)):z("",!0)])}const Mt=Yo(qo,[["render",Ct],["__scopeId","data-v-6a533295"]]),Dt=(t,e,s)=>{console.error("Global Error:",t),console.error("Component:",e),console.error("Error Info:",s)},ue=co(Mt);ue.config.errorHandler=Dt;ue.config.performance=!0;try{ue.mount("#app"),console.log("✓ Character Canvas initialized successfully")}catch(t){console.error("Failed to mount Vue app:",t),document.querySelector("#app").innerHTML=`
    <div style="padding: 20px; font-family: system-ui;">
      <h1 style="color: #c33;">Application Failed to Load</h1>
      <p>An error occurred while initializing the application.</p>
      <pre style="background: #f5f5f5; padding: 10px; border-radius: 4px; overflow: auto;">
${t.stack||t.message}
      </pre>
      <button onclick="location.reload()" style="padding: 10px 20px; border-radius: 6px; border: none; background: #111; color: #fff; cursor: pointer;">
        Reload Page
      </button>
    </div>
  `}
//# sourceMappingURL=index-HAv4h4zh.js.map
